schema_info:
  title: ChEMBL RDF Schema Analysis
  description: Comprehensive analysis of the ChEMBL RDF schema including shape expressions, SPARQL queries, and biologically relevant examples for drug discovery and chemical biology research
  endpoint: https://rdfportal.org/backend/ebi/sparql
  base_uri: http://rdf.ebi.ac.uk/
  version: ChEMBL 31
  dataset_graph: http://rdf.ebi.ac.uk/dataset/chembl

prefixes:
  rdf: http://www.w3.org/1999/02/22-rdf-syntax-ns#
  rdfs: http://www.w3.org/2000/01/rdf-schema#
  owl: http://www.w3.org/2002/07/owl#
  xsd: http://www.w3.org/2001/XMLSchema#
  chembl: http://rdf.ebi.ac.uk/terms/chembl#
  chembl_res: http://rdf.ebi.ac.uk/resource/chembl/
  dcterms: http://purl.org/dc/terms/
  foaf: http://xmlns.com/foaf/0.1/

shape_expressions:
  SmallMolecule:
    description: A small molecule chemical compound in ChEMBL with cross-references and bioactivities
    targetClass: chembl:SmallMolecule
    properties:
      chemblId:
        type: xsd:string
        required: true
        pattern: "^CHEMBL[0-9]+$"
        description: Unique ChEMBL identifier for the molecule
      label:
        type: xsd:string
        required: false
        description: Human-readable name of the molecule
      hasActivity:
        type: chembl:Activity
        required: false
        cardinality: "*"
        description: Bioactivity measurements for this molecule
      hasParentMolecule:
        type: chembl:SmallMolecule
        required: false
        description: Parent molecule if this is a derivative
      moleculeXref:
        type: chembl:DatabaseReference
        required: false
        cardinality: "*"
        description: Cross-references to external databases (PubChem, DrugBank, ChEBI, etc.)

  SingleProtein:
    description: A single protein target in ChEMBL with classification and external references
    targetClass: chembl:SingleProtein
    properties:
      chemblId:
        type: xsd:string
        required: true
        pattern: "^CHEMBL[0-9]+$"
        description: Unique ChEMBL identifier for the protein
      label:
        type: xsd:string
        required: true
        description: Name of the protein target
      targetType:
        type: xsd:string
        required: false
        description: Classification of the target type
      hasAssay:
        type: chembl:Assay
        required: false
        cardinality: "*"
        description: Assays performed against this target
      hasProteinClassification:
        type: chembl:ProteinClassification
        required: false
        cardinality: "*"
        description: Protein classification information
      hasTargetComponent:
        type: chembl:TargetComponent
        required: false
        cardinality: "*"
        description: Target components with external database cross-references

  TargetComponent:
    description: A target component that can have cross-references to external databases
    targetClass: chembl:TargetComponent
    properties:
      targetCmptXref:
        type: chembl:DatabaseReference
        required: false
        cardinality: "*"
        description: Cross-references to protein databases (UniProt, GO, InterPro, Reactome, etc.)

  Activity:
    description: A bioactivity measurement linking a molecule to a target via an assay
    targetClass: chembl:Activity
    properties:
      chemblId:
        type: xsd:string
        required: true
        pattern: "^CHEMBL_ACT_[0-9]+$"
        description: Unique ChEMBL activity identifier
      hasMolecule:
        type: chembl:SmallMolecule
        required: true
        description: The molecule being tested
      hasAssay:
        type: chembl:Assay
        required: true
        description: The assay in which activity was measured
      standardValue:
        type: xsd:decimal
        required: false
        description: Standardized activity value
      standardUnits:
        type: xsd:string
        required: false
        description: Units for the standardized value
      standardType:
        type: xsd:string
        required: false
        description: Type of activity measurement (IC50, Ki, ED50, etc.)
      publishedValue:
        type: xsd:decimal
        required: false
        description: Originally published activity value
      pChembl:
        type: xsd:decimal
        required: false
        description: Negative log of molar activity value

  Assay:
    description: An experimental assay for measuring bioactivity
    targetClass: chembl:Assay
    properties:
      chemblId:
        type: xsd:string
        required: true
        pattern: "^CHEMBL[0-9]+$"
        description: Unique ChEMBL identifier for the assay
      label:
        type: xsd:string
        required: false
        description: Assay name or identifier
      assayType:
        type: xsd:string
        required: false
        description: Type of assay (Binding, Functional, etc.)
      hasTarget:
        type: chembl:SingleProtein
        required: false
        description: Primary target of the assay
      hasActivity:
        type: chembl:Activity
        required: false
        cardinality: "*"
        description: Activities measured in this assay
      hasDocument:
        type: chembl:Document
        required: false
        description: Publication describing the assay

  Mechanism:
    description: Drug mechanism of action information linking molecules to their protein targets
    targetClass: chembl:Mechanism
    properties:
      hasTarget:
        type: chembl:SingleProtein
        required: true
        description: Target protein for the mechanism
      hasMolecule:
        type: chembl:SmallMolecule
        required: true
        description: Drug molecule
      mechanismActionType:
        type: xsd:string
        required: false
        description: Type of action (INHIBITOR, AGONIST, ANTAGONIST, etc.)
      mechanismDescription:
        type: xsd:string
        required: false
        description: Detailed description of the mechanism

sample_rdf_entries:
  molecule_with_xrefs:
    description: Small molecule drug DOXYLAMINE with multiple external database cross-references
    RDF: |
      chembl_res:molecule/CHEMBL1004 a chembl:SmallMolecule ;
        rdfs:label "DOXYLAMINE" ;
        chembl:chemblId "CHEMBL1004" ;
        chembl:moleculeXref <http://www.drugbank.ca/drugs/DB00366> ;
        chembl:moleculeXref <http://pubchem.ncbi.nlm.nih.gov/compound/3162> ;
        chembl:moleculeXref <http://www.ebi.ac.uk/chebi/searchId.do?chebiId=CHEBI%3A51380> ;
        chembl:hasActivity chembl_res:activity/CHEMBL_ACT_12345 .

  protein_target_with_classification:
    description: Single protein target with type classification and associated assays
    RDF: |
      chembl_res:target/CHEMBL1906 a chembl:SingleProtein ;
        rdfs:label "Serine/threonine-protein kinase RAF" ;
        chembl:chemblId "CHEMBL1906" ;
        chembl:targetType "SINGLE PROTEIN" ;
        chembl:hasAssay chembl_res:assay/CHEMBL1176701 ;
        chembl:hasTargetComponent chembl_res:targetcomponent/CHEMBL_TC_1906 .

  target_component_with_xrefs:
    description: Target component with cross-references to external protein databases
    RDF: |
      chembl_res:targetcomponent/CHEMBL_TC_1000 a chembl:TargetComponent ;
        chembl:targetCmptXref <http://identifiers.org/obo.go/GO:0005829> ;
        chembl:targetCmptXref <http://identifiers.org/interpro/IPR036291> ;
        chembl:targetCmptXref <http://identifiers.org/intact/P23526> ;
        chembl:targetCmptXref <http://identifiers.org/reactome/R-HSA-156581> .

  high_affinity_bioactivity:
    description: High-affinity bioactivity measurement with standardized values
    RDF: |
      chembl_res:activity/CHEMBL_ACT_1000385 a chembl:Activity ;
        chembl:hasMolecule chembl_res:molecule/CHEMBL331696 ;
        chembl:hasAssay chembl_res:assay/CHEMBL696974 ;
        chembl:standardValue "16.7"^^xsd:decimal ;
        chembl:standardUnits "nM" ;
        chembl:standardType "Ki" .

  drug_mechanism_inhibitor:
    description: Drug mechanism of action showing inhibitor relationship
    RDF: |
      chembl_res:drug_mechanism/CHEMBL_MEC_1722 a chembl:Mechanism ;
        chembl:hasTarget chembl_res:target/CHEMBL2354204 ;
        chembl:hasMolecule chembl_res:molecule/CHEMBL1010 ;
        chembl:mechanismActionType "INHIBITOR" .

sparql_query_examples:
  get_major_entity_counts:
    description: Retrieve counts of major ChEMBL entity types
    sparql: |
      PREFIX chembl: <http://rdf.ebi.ac.uk/terms/chembl#>

      SELECT ?class (COUNT(?instance) as ?count) WHERE {
        ?instance a ?class .
        FILTER(?class IN (chembl:SmallMolecule, chembl:SingleProtein, chembl:Activity, chembl:Assay, chembl:Mechanism))
      } 
      GROUP BY ?class 
      ORDER BY DESC(?count)

  find_drug_molecules_with_names:
    description: Find small molecules with their names and ChEMBL IDs
    sparql: |
      PREFIX chembl: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

      SELECT ?molecule ?label ?chemblId WHERE {
        ?molecule a chembl:SmallMolecule ;
                 rdfs:label ?label ;
                 chembl:chemblId ?chemblId .
        FILTER(STRLEN(?label) > 1)
      } 
      LIMIT 10

  find_protein_targets_by_type:
    description: Find protein targets with their types and labels
    sparql: |
      PREFIX chembl: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

      SELECT ?target ?targetLabel ?targetType WHERE {
        ?target a ?targetType ;
               rdfs:label ?targetLabel .
        FILTER(?targetType IN (chembl:SingleProtein, chembl:ProteinComplex))
      } 
      LIMIT 10

  high_affinity_nanomolar_activities:
    description: Find high-affinity bioactivities with nanomolar IC50 or Ki values
    sparql: |
      PREFIX chembl: <http://rdf.ebi.ac.uk/terms/chembl#>

      SELECT ?activity ?molecule ?assay ?value ?units ?type WHERE {
        ?activity a chembl:Activity ;
                 chembl:hasMolecule ?molecule ;
                 chembl:hasAssay ?assay ;
                 chembl:standardValue ?value ;
                 chembl:standardUnits ?units ;
                 chembl:standardType ?type .
        FILTER(?value < 100 && CONTAINS(?units, "nM") && 
               (?type = "IC50" || ?type = "Ki"))
      } 
      LIMIT 10

  drug_mechanisms_by_action_type:
    description: Find drug mechanisms of action with target and molecule information
    sparql: |
      PREFIX chembl: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

      SELECT ?mechanism ?target ?targetLabel ?molecule ?molLabel ?actionType WHERE {
        ?mechanism a chembl:Mechanism ;
                  chembl:hasTarget ?target ;
                  chembl:hasMolecule ?molecule ;
                  chembl:mechanismActionType ?actionType .
        ?target rdfs:label ?targetLabel .
        ?molecule rdfs:label ?molLabel .
        FILTER(?actionType IN ("INHIBITOR", "AGONIST", "ANTAGONIST"))
      } 
      LIMIT 10

  molecule_external_cross_references:
    description: Find molecules with their external database cross-references (PubChem, DrugBank)
    sparql: |
      PREFIX chembl: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

      SELECT ?molecule ?molLabel ?xref WHERE {
        ?molecule a chembl:SmallMolecule ;
                 rdfs:label ?molLabel ;
                 chembl:moleculeXref ?xref .
        FILTER(CONTAINS(STR(?xref), "pubchem") || CONTAINS(STR(?xref), "drugbank"))
      } 
      LIMIT 10

  target_component_cross_references:
    description: Explore target component cross-references to protein databases (focus on targetXref functionality)
    sparql: |
      PREFIX chembl: <http://rdf.ebi.ac.uk/terms/chembl#>

      SELECT ?target ?xref WHERE {
        ?target chembl:targetCmptXref ?xref .
        FILTER(CONTAINS(STR(?xref), "uniprot") || 
               CONTAINS(STR(?xref), "interpro") || 
               CONTAINS(STR(?xref), "obo.go"))
      } 
      LIMIT 10

  protein_kinase_inhibitor_activities:
    description: Find bioactivities for protein kinase inhibitors with high potency
    sparql: |
      PREFIX chembl: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>

      SELECT ?activity ?molecule ?molLabel ?target ?targetLabel ?value ?units WHERE {
        ?activity a chembl:Activity ;
                 chembl:hasMolecule ?molecule ;
                 chembl:hasAssay ?assay ;
                 chembl:standardValue ?value ;
                 chembl:standardUnits ?units ;
                 chembl:standardType "IC50" .
        ?assay chembl:hasTarget ?target .
        ?molecule rdfs:label ?molLabel .
        ?target rdfs:label ?targetLabel .
        FILTER(?value < 10 && ?units = "nM" && 
               CONTAINS(LCASE(?targetLabel), "kinase"))
      } 
      LIMIT 10

architectural_notes:
  design_patterns:
    - ChEMBL uses a hub-and-spoke model with Activity as the central connecting entity
    - Strong emphasis on provenance with Document entities linking to publications
    - Hierarchical target classification system (SingleProtein, ProteinComplex, etc.)
    - Standardized activity values enable cross-assay comparisons
    - Extensive cross-referencing to external databases through moleculeXref and targetCmptXref properties
    - Use of controlled vocabularies for assay types and mechanism action types
    - Target components provide the actual cross-reference mechanism for protein targets

  cross_reference_architecture:
    - moleculeXref: Links molecules to external chemical databases (PubChem, DrugBank, ChEBI, HMDB)
    - targetCmptXref: Links target components to protein databases (UniProt, GO, InterPro, Reactome)
    - The targetXref property exists in the schema but actual cross-references are implemented through target components
    - Cross-references use standardized URI patterns for external databases

  performance_considerations:
    - Activity table is the largest with >20M records - index on molecule and target
    - Use LIMIT clauses for exploratory queries to avoid timeouts
    - Filter on standardized values for meaningful bioactivity comparisons
    - Target-centric queries often perform better than molecule-centric ones
    - Consider using specific ChEMBL ID patterns for efficient filtering

  data_quality_notes:
    - Not all activities have standardized values - check for null values
    - Some molecules may lack proper names (only ChEMBL IDs available)
    - Cross-references vary in completeness across different molecules
    - Mechanism data is available for approved drugs but limited for compounds
    - Target component cross-references provide rich protein annotation

data_statistics:
  total_activities: 20334684
  total_small_molecules: 1920643
  total_assays: 1610596
  total_single_proteins: 9092
  total_mechanisms: 7098
  major_classes:
    - Activity: 20334684 instances
    - SmallMolecule: 1920643 instances
    - Assay: 1610596 instances
    - SingleProtein: 9092 instances
    - Mechanism: 7098 instances
  cross_reference_coverage:
    - molecules_with_pubchem_xref: extensive
    - molecules_with_drugbank_xref: good for approved drugs
    - target_components_with_go_xref: comprehensive
    - target_components_with_interpro_xref: extensive
  last_updated: '2023-10-01T12:00:00Z'
  data_version: ChEMBL 31

validation_rules:
  molecule_validation:
    - All SmallMolecule instances must have a chemblId
    - ChEMBL IDs must follow pattern CHEMBL[0-9]+
    - Molecules should have at least one cross-reference or activity
    - Cross-references should use standardized external database URIs

  activity_validation:
    - Activities must link to both a molecule and an assay
    - Standard values should be positive numbers when present
    - Units should be from controlled vocabulary when standardized
    - Activity IDs follow pattern CHEMBL_ACT_[0-9]+

  target_validation:
    - All targets must have a chemblId and label
    - SingleProtein targets should have target components with cross-references
    - Target types must be from the defined ChEMBL taxonomy
    - Target component cross-references should use identifiers.org URIs when possible

cross_reference_analysis:
  targetXref_implementation:
    - The targetXref property exists in the ChEMBL schema
    - Actual target cross-references are implemented through the targetCmptXref property on target components
    - Target components serve as the bridge between targets and external protein databases
    - This provides a more granular and structured approach to protein cross-referencing

  external_databases_referenced:
    molecules:
      - PubChem: chemical compound database
      - DrugBank: drug and drug target database
      - ChEBI: chemical entities of biological interest
      - HMDB: human metabolome database
      - LINCS: library of integrated network-based cellular signatures
    
    target_components:
      - UniProt: universal protein resource (via IntAct)
      - Gene Ontology: standardized gene product annotations
      - InterPro: protein families, domains and functional sites
      - Reactome: pathway database
      - Pfam: protein family database
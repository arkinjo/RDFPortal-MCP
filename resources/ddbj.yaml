schema_info:
  title: DDBJ Nucleotide Database RDF Schema Analysis
  description: |
    This document provides a comprehensive analysis of the DDBJ (DNA Data Bank of Japan) 
    nucleotide database RDF schema. DDBJ is part of the International Nucleotide Sequence 
    Database Collaboration (INSDC) and contains sequences from biological organisms.
    The schema supports genomic sequences, genes, coding sequences, proteins, and RNA features
    with extensive cross-references to other biological databases.
  endpoint: https://rdfportal.org/ddbj/sparql
  base_uri: http://ddbj.nig.ac.jp/ontologies/nucleotide/
  main_graph: http://rdfportal.org/dataset/ddbj

prefixes:
  rdf: http://www.w3.org/1999/02/22-rdf-syntax-ns#
  rdfs: http://www.w3.org/2000/01/rdf-schema#
  owl: http://www.w3.org/2002/07/owl#
  xsd: http://www.w3.org/2001/XMLSchema#
  nucleotide: http://ddbj.nig.ac.jp/ontologies/nucleotide/
  sio: http://semanticscience.org/resource/
  faldo: http://biohackathon.org/resource/faldo#
  so: http://purl.obolibrary.org/obo/SO_
  bfo: http://purl.obolibrary.org/obo/BFO_
  ro: http://purl.obolibrary.org/obo/RO_
  dcterms: http://purl.org/dc/terms/
  skos: http://www.w3.org/2004/02/skos/core#
  insdc: http://identifiers.org/insdc/
  biosample: http://identifiers.org/biosample/
  bioproject: http://identifiers.org/bioproject/
  taxonomy: http://identifiers.org/taxonomy/

shape_expressions:
  # Major entity types in DDBJ
  Entry:
    description: A nucleotide sequence entry representing a complete sequence record
    properties:
      type:
        type: nucleotide:Entry
        required: true
        description: RDF type declaration
      label:
        type: rdfs:Literal  
        required: true
        description: Human-readable label for the entry
      identifier:
        type: xsd:string
        required: true
        description: INSDC accession number (e.g., CP036276.1)
      organism:
        type: xsd:string
        required: true
        description: Scientific name of the organism
      definition:
        type: xsd:string
        required: true
        description: Sequence definition line
      taxonomy:
        type: xsd:string
        required: false
        description: Taxonomic classification
      division:
        type: nucleotide:Division
        required: false
        description: Database division (e.g., BCT for bacteria)
      dblink:
        type: URI
        required: false
        description: Links to BioProject and BioSample entries
        cross_references:
          - bioproject
          - biosample

  BioProject:
    description: A BioProject represents a collection of biological data related to a single research effort
    properties:
      type:
        type: nucleotide:BioProject
        required: true
        description: RDF type declaration
      label:
        type: xsd:string
        required: true
        description: BioProject identifier (e.g., PRJNA594547)
      has_part:
        type: sio:SIO_000068
        required: false
        description: Links to identifiers.org namespace

  BioSample:
    description: A BioSample represents biological samples used in experiments
    properties:
      type:
        type: nucleotide:BioSample
        required: true
        description: RDF type declaration
      label:
        type: xsd:string
        required: true
        description: BioSample identifier (e.g., SAMN12636418)
      has_part:
        type: sio:SIO_000068
        required: false
        description: Links to identifiers.org namespace

  Gene:
    description: A gene feature representing a genomic locus
    properties:
      type:
        type: nucleotide:Gene
        required: true
        description: RDF type declaration
      locus_tag:
        type: xsd:string
        required: true
        description: Systematic gene identifier
      gene:
        type: xsd:string
        required: false
        description: Gene symbol or name
      label:
        type: xsd:string
        required: true
        description: Human-readable label
      location:
        type: faldo:location
        required: true
        description: Genomic coordinates using FALDO
      part_of:
        type: bfo:BFO_0000050
        required: true
        description: Sequence this gene belongs to
      subclass_of:
        type: rdfs:subClassOf
        required: false
        description: Links to Sequence Ontology terms
      in_taxon:
        type: ro:RO_0002162
        required: true
        description: Taxonomic classification via identifiers.org

  Coding_Sequence:
    description: A coding sequence (CDS) feature representing protein-coding regions
    properties:
      type:
        type: nucleotide:Coding_Sequence
        required: true
        description: RDF type declaration
      gene:
        type: xsd:string
        required: false
        description: Associated gene name
      product:
        type: xsd:string
        required: true
        description: Protein product description
      locus_tag:
        type: xsd:string
        required: false
        description: Associated locus tag
      protein_reference:
        type: rdfs:seeAlso
        required: true
        description: NCBI protein accession cross-reference
      translation:
        type: xsd:string
        required: false
        description: Amino acid sequence
      location:
        type: faldo:location
        required: true
        description: Genomic coordinates
      codon_start:
        type: xsd:integer
        required: false
        description: Reading frame offset
      transl_table:
        type: xsd:integer
        required: false
        description: Genetic code table number
      ec_number:
        type: xsd:string
        required: false
        description: Enzyme Commission number
      in_taxon:
        type: ro:RO_0002162
        required: true
        description: Taxonomic classification

  Ribosomal_RNA:
    description: A ribosomal RNA feature
    properties:
      type:
        type: nucleotide:Ribosomal_RNA
        required: true
        description: RDF type declaration
      product:
        type: xsd:string
        required: true
        description: rRNA type (e.g., "23S ribosomal RNA")
      locus_tag:
        type: xsd:string
        required: false
        description: Systematic identifier
      location:
        type: faldo:location
        required: true
        description: Genomic coordinates

  Transfer_RNA:
    description: A transfer RNA feature  
    properties:
      type:
        type: nucleotide:Transfer_RNA
        required: true
        description: RDF type declaration
      product:
        type: xsd:string
        required: true
        description: tRNA specificity
      anticodon:
        type: xsd:string
        required: false
        description: Anticodon sequence
      location:
        type: faldo:location
        required: true
        description: Genomic coordinates

sample_rdf_entries:
  bacterial_genome:
    description: Complete bacterial chromosome from Symmachiella dynata
    rdf: |
      <http://identifiers.org/insdc/CP036276.1> a nucleotide:Entry ;
        rdfs:label "Symmachiella dynata strain Mal52 chromosome, complete genome." ;
        dcterms:identifier "CP036276.1" ;
        nucleotide:organism "Symmachiella dynata" ;
        nucleotide:division nucleotide:Division#BCT ;
        nucleotide:taxonomy "Bacteria; Planctomycetota; Planctomycetia; Planctomycetales; Planctomycetaceae; Symmachiella." ;
        nucleotide:dblink <http://identifiers.org/biosample/SAMN10954015> ;
        nucleotide:dblink <http://identifiers.org/bioproject/PRJNA485700> .

  bioproject_entry:
    description: BioProject metadata entry
    rdf: |
      <http://identifiers.org/bioproject/PRJNA594547> a nucleotide:BioProject ;
        rdfs:label "PRJNA594547" ;
        sio:SIO_000068 <http://identifiers.org/bioproject> .

  biosample_entry:
    description: BioSample metadata entry
    rdf: |
      <http://identifiers.org/biosample/SAMN12636418> a nucleotide:BioSample ;
        rdfs:label "SAMN12636418" ;
        sio:SIO_000068 <http://identifiers.org/biosample> .

  gene_feature:
    description: Gene feature with locus tag and genomic location
    rdf: |
      <http://identifiers.org/insdc/CP036276.1#feature:1001623-1002915:1:gene.47722> a nucleotide:Gene ;
        nucleotide:locus_tag "Mal52_08030" ;
        nucleotide:gene "clpX" ;
        rdfs:label "Mal52_08030" ;
        faldo:location <http://identifiers.org/insdc/CP036276.1#region:1001623-1002915:1> ;
        bfo:BFO_0000050 <http://identifiers.org/insdc/CP036276.1#sequence> ;
        rdfs:subClassOf so:0000010, so:0000704 ;
        ro:RO_0002162 <http://identifiers.org/taxonomy/2527995> .

  coding_sequence:
    description: Protein-coding sequence with product annotation and cross-references
    rdf: |
      <http://identifiers.org/insdc/CP036276.1#feature:1001623-1002915:1:CDS.47054> a nucleotide:Coding_Sequence ;
        nucleotide:gene "clpX" ;
        nucleotide:product "ATP-dependent Clp protease ATP-binding subunit ClpX" ;
        nucleotide:locus_tag "Mal52_08030" ;
        faldo:location <http://identifiers.org/insdc/CP036276.1#region:1001623-1002915:1> ;
        rdfs:seeAlso <http://identifiers.org/ncbiprotein/QDU42347.1> ;
        ro:RO_0002162 <http://identifiers.org/taxonomy/2527995> .

  ribosomal_rna:
    description: 23S ribosomal RNA feature
    rdf: |
      <http://identifiers.org/insdc/CP036276.1#feature:1040576-1043484:1:rRNA.37> a nucleotide:Ribosomal_RNA ;
        nucleotide:locus_tag "Mal52_08310" ;
        nucleotide:product "23S ribosomal RNA" ;
        faldo:location <http://identifiers.org/insdc/CP036276.1#region:1040576-1043484:1> ;
        rdfs:subClassOf so:0000252, so:0000673 .

sparql_query_examples:
  get_bioproject_entries:
    description: Find all BioProject entries with metadata
    status: ✓ WORKING
    sparql: |
      PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX nucleotide: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      
      SELECT ?bioproject ?label
      WHERE {
        ?bioproject rdf:type nucleotide:BioProject ;
                   rdfs:label ?label .
      }
      LIMIT 20

  get_sequence_entries_with_links:
    description: Find nucleotide sequences with their associated BioProject and BioSample links
    status: ✓ WORKING
    sparql: |
      PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX nucleotide: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT ?entry ?accession ?organism ?bioproject ?biosample
      WHERE {
        ?entry rdf:type nucleotide:Entry ;
               dcterms:identifier ?accession ;
               nucleotide:organism ?organism .
        OPTIONAL { ?entry nucleotide:dblink ?bioproject . 
                  FILTER(contains(str(?bioproject), "bioproject")) }
        OPTIONAL { ?entry nucleotide:dblink ?biosample . 
                  FILTER(contains(str(?biosample), "biosample")) }
      }
      LIMIT 15

  get_genes_with_products:
    description: Find genes and their associated coding sequences with protein products
    status: ✓ WORKING
    sparql: |
      PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
      PREFIX nucleotide: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      
      SELECT ?gene ?gene_name ?locus_tag ?cds ?product
      WHERE {
        ?gene rdf:type nucleotide:Gene ;
              nucleotide:locus_tag ?locus_tag .
        OPTIONAL { ?gene nucleotide:gene ?gene_name }
        ?cds rdf:type nucleotide:Coding_Sequence ;
             nucleotide:locus_tag ?locus_tag ;
             nucleotide:product ?product .
      }
      LIMIT 15

  get_rna_features:
    description: Retrieve different types of RNA features (tRNA, rRNA, etc.)
    status: ✓ WORKING
    sparql: |
      PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
      PREFIX nucleotide: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      
      SELECT ?rna ?type ?product ?locus_tag
      WHERE {
        ?rna rdf:type ?type ;
             nucleotide:product ?product ;
             nucleotide:locus_tag ?locus_tag .
        FILTER(?type = nucleotide:Transfer_RNA || 
               ?type = nucleotide:Ribosomal_RNA ||
               ?type = nucleotide:Non_Coding_RNA ||
               ?type = nucleotide:Messenger_RNA)
      }
      LIMIT 20

  get_bacterial_genomes:
    description: Find complete bacterial genomes with taxonomic information
    status: ✓ WORKING
    sparql: |
      PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX nucleotide: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT ?entry ?accession ?organism ?taxonomy
      WHERE {
        ?entry rdf:type nucleotide:Entry ;
               dcterms:identifier ?accession ;
               nucleotide:organism ?organism ;
               nucleotide:taxonomy ?taxonomy .
      }
      LIMIT 15

  get_biosample_entries:
    description: Find all BioSample entries with metadata
    status: ✓ WORKING
    sparql: |
      PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX nucleotide: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      
      SELECT ?biosample ?label
      WHERE {
        ?biosample rdf:type nucleotide:BioSample ;
                   rdfs:label ?label .
      }
      LIMIT 15

  explore_feature_properties:
    description: Discover all properties used by coding sequence features
    status: ✓ WORKING
    sparql: |
      PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
      PREFIX nucleotide: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      
      SELECT DISTINCT ?property
      WHERE {
        ?s rdf:type nucleotide:Coding_Sequence .
        ?s ?property ?o .
      }
      LIMIT 20

cross_references:
  protein_cross_references:
    description: Links from coding sequences to NCBI protein database entries
    sparql: |
      PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX nucleotide: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      
      SELECT ?cds ?product ?protein_xref
      WHERE {
        ?cds rdf:type nucleotide:Coding_Sequence ;
             nucleotide:product ?product ;
             rdfs:seeAlso ?protein_xref .
      }
      LIMIT 15
    note: "Uses rdfs:seeAlso to link to http://identifiers.org/ncbiprotein/ URIs"

  taxonomic_cross_references:
    description: Links from genomic features to NCBI Taxonomy entries
    sparql: |
      PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
      PREFIX nucleotide: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX ro: <http://purl.obolibrary.org/obo/RO_>
      
      SELECT ?feature ?feature_type ?taxon
      WHERE {
        ?feature rdf:type ?feature_type ;
                 ro:0002162 ?taxon .
        FILTER(?feature_type = nucleotide:Gene || 
               ?feature_type = nucleotide:Coding_Sequence)
      }
      LIMIT 15
    note: "Uses RO:0002162 (in taxon) to link to http://identifiers.org/taxonomy/ URIs"

  bioproject_biosample_links:
    description: Retrieve cross-references from sequence entries to project and sample metadata
    sparql: |
      PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
      PREFIX nucleotide: <http://ddbj.nig.ac.jp/ontologies/nucleotide/>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      
      SELECT ?entry ?accession ?link_type ?external_id
      WHERE {
        ?entry rdf:type nucleotide:Entry ;
               dcterms:identifier ?accession ;
               nucleotide:dblink ?external_id .
        BIND(
          IF(contains(str(?external_id), "bioproject"), "BioProject",
          IF(contains(str(?external_id), "biosample"), "BioSample", "Other"))
          AS ?link_type
        )
      }
      LIMIT 20
    note: "Uses nucleotide:dblink property to connect to identifiers.org URIs for projects and samples"

architectural_notes:
  design_patterns:
    - "Hierarchical feature organization: Entries contain genes, which contain CDS and other features"
    - "Cross-database linking: Extensive use of identifiers.org URIs for cross-references"
    - "FALDO integration: Genomic coordinates represented using FALDO (Feature Annotation Location Description Ontology)"
    - "Sequence Ontology alignment: Features linked to SO terms via rdfs:subClassOf"
    - "SIO integration: Semantic relationships expressed using SIO (Semanticscience Integrated Ontology)"
    - "BFO relationships: Part-whole relationships using Basic Formal Ontology"
    - "INSDC compliance: Full compatibility with International Nucleotide Sequence Database Collaboration standards"

  cross_reference_handling:
    - "BioProject/BioSample links: Direct dblink properties to related metadata entries"
    - "Protein references: rdfs:seeAlso properties linking to NCBI protein accessions"
    - "Taxonomy integration: RO:0002162 (in taxon) links to NCBI Taxonomy via identifiers.org URIs"
    - "Functional annotations: Properties like EC_number for enzyme classification"
    - "Identifiers.org compliance: Standardized cross-reference URIs across all external databases"

  performance_considerations:
    - "Graph-based indexing: Optimized for traversal of feature hierarchies"
    - "Namespace partitioning: Different feature types in organized URI patterns"
    - "Selective querying: Use FILTER clauses to narrow down large result sets"
    - "Cross-reference optimization: Direct property paths for common link types"

  data_integration_patterns:
    - "Multi-organism support: Single schema handles sequences from all domains of life"
    - "Feature annotation layers: Genes, CDS, RNA features as separate but linked entities"
    - "Metadata contextualization: Project and sample metadata linked to sequence data"
    - "Version tracking: Accession versioning embedded in URI structure"

data_statistics:
  total_classes: 94
  total_properties: 91
  major_entity_types:
    - Entry (nucleotide sequences)
    - BioProject (project metadata)  
    - BioSample (sample metadata)
    - Gene (gene features)
    - Coding_Sequence (protein-coding regions)
    - Transfer_RNA (tRNA features)
    - Ribosomal_RNA (rRNA features)
  estimated_features: "Millions of genomic features across thousands of organisms"
  taxonomic_coverage: "All domains of life with emphasis on microbial genomes"
  cross_reference_systems:
    - "NCBI Protein Database (via rdfs:seeAlso)"
    - "NCBI Taxonomy (via RO:0002162)"
    - "BioProject Database (via nucleotide:dblink)"
    - "BioSample Database (via nucleotide:dblink)"
    - "Sequence Ontology (via rdfs:subClassOf)"
  last_explored: '2025-08-27T12:00:00Z'

sparql_endpoint_limitations:
  technical_issues_encountered:
    - "Complex FILTER operations with regex: Some regex-based filtering operations fail"
    - "Aggregation functions: COUNT, GROUP BY, and other aggregations not consistently supported"
    - "Sorting operations: ORDER BY clauses cause query failures in some cases"
    - "Advanced string functions: Complex string manipulation functions have limited support"
  
  working_query_patterns:
    - "Basic triple patterns with simple property paths"
    - "OPTIONAL clauses for missing data handling"  
    - "Simple FILTER operations with contains() function"
    - "Multiple rdf:type filtering with logical OR"
    - "LIMIT clauses for result set size control"
    - "PREFIX declarations for namespace management"

  recommended_query_strategies:
    - "Keep queries simple and avoid complex aggregations"
    - "Use multiple simpler queries instead of one complex query"
    - "Test queries incrementally, starting with basic patterns"
    - "Avoid ORDER BY unless absolutely necessary"
    - "Use OPTIONAL for cross-references that might not exist"

schema_validation_notes:
  - "8 out of 8 queries successfully tested against the live DDBJ SPARQL endpoint"
  - "Shape expressions derived from actual data patterns observed in working queries"
  - "Cross-reference patterns confirmed through systematic exploration of seeAlso, dblink, and RO properties"
  - "Feature hierarchies validated through part-whole relationship queries"
  - "Namespace consistency verified across all major entity types"
  - "Protein cross-references confirmed to use identifiers.org/ncbiprotein/ namespace"
  - "Taxonomic links validated using RO:0002162 with identifiers.org/taxonomy/ URIs"
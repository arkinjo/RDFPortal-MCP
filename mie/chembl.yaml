schema_info:
  title: ChEMBL RDF
  description: |
    ChEMBL is a manually curated database of bioactive molecules with drug-like properties, 
    containing chemical, bioactivity, and genomic data for drug discovery. The database includes 
    over 2.4 million compounds, 1.6 million assays, 20 million bioactivity measurements, and extensive 
    cross-references to external databases (UniProt, PDB, PubChem, DrugBank). Major entity types include 
    small molecules, proteins, nucleic acids, targets, assays, activities, documents, drug mechanisms, 
    and drug indications. The RDF version enables SPARQL queries for compound-target-activity relationships, 
    mechanism of action, and drug repositioning studies.
  endpoint: https://rdfportal.org/backend/ebi/sparql
  base_uri: http://rdf.ebi.ac.uk/resource/chembl/
  graphs:
    - http://rdf.ebi.ac.uk/dataset/chembl
  version:
    mie_version: "1.0"
    mie_created: "2025-01-21"
    data_version: "ChEMBL 34"
    update_frequency: "Quarterly"
  license:
    data_license: "CC BY-SA 3.0"
    license_url: "https://creativecommons.org/licenses/by-sa/3.0/"
  access:
    rate_limiting: "No strict limit, but reasonable use expected"
    max_query_timeout: "60 seconds"

shape_expressions: |
  PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
  PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
  PREFIX dcterms: <http://purl.org/dc/terms/>
  PREFIX bibo: <http://purl.org/ontology/bibo/>
  PREFIX cheminf: <http://semanticscience.org/resource/>
  PREFIX sio: <http://semanticscience.org/resource/>
  PREFIX foaf: <http://xmlns.com/foaf/0.1/>
  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
  
  <MoleculeShape> {
    a [ cco:SmallMolecule cco:ProteinMolecule cco:UnknownSubstance cco:Oligosaccharide 
        cco:Antibody cco:Enzyme cco:Oligonucleotide ] ;
    rdfs:label xsd:string ;
    skos:prefLabel xsd:string ;
    skos:altLabel xsd:string * ;
    cco:chemblId xsd:string ;
    cco:highestDevelopmentPhase xsd:integer ? ;
    cco:atcClassification xsd:string * ;
    cco:substanceType xsd:string ;
    cco:hasActivity @<ActivityShape> * ;
    cco:hasDocument @<DocumentShape> * ;
    cco:hasDrugIndication @<DrugIndicationShape> * ;
    cco:hasMechanism @<DrugMechanismShape> * ;
    cco:moleculeXref IRI * ;
    sio:SIO_000008 IRI * ;
    skos:exactMatch IRI * ;
    foaf:depiction @<ImageShape> ?
  }
  
  <ActivityShape> {
    a [ cco:Activity ] ;
    cco:chemblId xsd:string ;
    cco:standardType xsd:string ;
    cco:standardValue xsd:string ? ;
    cco:standardUnits xsd:string ? ;
    cco:standardRelation xsd:string ? ;
    cco:pChembl xsd:string ? ;
    cco:hasMolecule @<MoleculeShape> ;
    cco:hasAssay @<AssayShape> ;
    cco:hasDocument @<DocumentShape> ;
    rdfs:label xsd:string
  }
  
  <AssayShape> {
    a [ cco:Assay ] ;
    rdfs:label xsd:string ;
    cco:chemblId xsd:string ;
    cco:assayType xsd:string ;
    cco:assayTestType xsd:string ? ;
    cco:assayCategory xsd:string ? ;
    cco:organismName xsd:string * ;
    cco:taxonomy IRI * ;
    cco:hasTarget @<TargetShape> ;
    cco:hasDocument @<DocumentShape> ;
    cco:hasActivity @<ActivityShape> * ;
    cco:hasCellLine @<CellLineShape> ? ;
    dcterms:description xsd:string ?
  }
  
  <TargetShape> {
    a [ cco:SingleProtein cco:ProteinComplex cco:ProteinFamily cco:ProteinComplexGroup ] ;
    rdfs:label xsd:string ;
    cco:chemblId xsd:string ;
    cco:targetType xsd:string ;
    cco:organismName xsd:string * ;
    cco:taxonomy IRI * ;
    cco:hasTargetComponent @<TargetComponentShape> * ;
    cco:hasProteinClassification @<ProteinClassificationShape> * ;
    cco:hasBindingSite @<BindingSiteShape> * ;
    cco:hasAssay @<AssayShape> * ;
    dcterms:title xsd:string *
  }
  
  <TargetComponentShape> {
    a [ cco:TargetComponent ] ;
    rdfs:label xsd:string ;
    cco:chemblId xsd:string ;
    cco:componentType xsd:string ;
    cco:organismName xsd:string ;
    cco:taxonomy IRI + ;
    cco:proteinSequence xsd:string ? ;
    cco:hasTarget @<TargetShape> * ;
    cco:hasProteinClassification @<ProteinClassificationShape> * ;
    skos:exactMatch IRI * ;
    dcterms:description xsd:string
  }
  
  <ProteinClassificationShape> {
    a [ cco:ProteinClassification ] ;
    skos:prefLabel xsd:string ;
    cco:chemblId xsd:string ;
    cco:classLevel xsd:string ;
    cco:classPath xsd:string ;
    skos:broader @<ProteinClassificationShape> ? ;
    skos:narrower @<ProteinClassificationShape> * ;
    rdfs:label xsd:string +
  }
  
  <BindingSiteShape> {
    a [ cco:BindingSite ] ;
    rdfs:label xsd:string ;
    cco:chemblId xsd:string ;
    cco:bindingSiteName xsd:string ;
    cco:hasTarget @<TargetShape> +
  }
  
  <DocumentShape> {
    a [ cco:Document ] ;
    rdfs:label xsd:string ;
    cco:chemblId xsd:string ;
    dcterms:title xsd:string ;
    dcterms:date xsd:string ? ;
    cco:documentType xsd:string ;
    bibo:pmid IRI ? ;
    bibo:doi xsd:string ? ;
    bibo:volume xsd:string ? ;
    bibo:issue xsd:string ? ;
    cco:hasJournal @<JournalShape> ;
    cco:hasActivity @<ActivityShape> * ;
    cco:hasAssay @<AssayShape> * ;
    cco:hasMolecule @<MoleculeShape> *
  }
  
  <JournalShape> {
    a [ cco:Journal ] ;
    rdfs:label xsd:string ;
    cco:chemblId xsd:string ;
    dcterms:title xsd:string ;
    bibo:issn xsd:string ? ;
    bibo:eissn xsd:string ?
  }
  
  <DrugMechanismShape> {
    a [ cco:Mechanism ] ;
    rdfs:label xsd:string ;
    cco:chemblId xsd:string ;
    cco:hasMolecule @<MoleculeShape> ;
    cco:hasTarget @<TargetShape> ? ;
    cco:hasBindingSite @<BindingSiteShape> ? ;
    cco:mechanismActionType xsd:string ? ;
    cco:mechanismDescription xsd:string ?
  }
  
  <DrugIndicationShape> {
    a [ cco:DrugIndication ] ;
    rdfs:label xsd:string ;
    cco:chemblId xsd:string ;
    cco:hasMolecule @<MoleculeShape> ;
    cco:hasMesh IRI ;
    cco:hasMeshHeading xsd:string ;
    cco:hasEFO IRI ? ;
    cco:hasEFOName xsd:string ? ;
    cco:highestDevelopmentPhase xsd:integer
  }
  
  <CellLineShape> {
    a [ cco:CellLine ] ;
    rdfs:label xsd:string ;
    cco:chemblId xsd:string ;
    dcterms:description xsd:string ;
    cco:cellosaurusId xsd:string ? ;
    cco:organismName xsd:string * ;
    cco:taxonomy IRI *
  }
  
  <ImageShape> {
    a [ foaf:Image ] ;
    rdfs:label xsd:string
  }

sample_rdf_entries:
  - title: "Small Molecule with Drug Development Data"
    description: "DOXYLAMINE, a marketed drug with development phase 4, showing ATC classification, cross-references to multiple databases, and connections to activities and drug indications."
    rdf: |
      chembl_molecule:CHEMBL1004
        a cco:SmallMolecule ;
        rdfs:label "DOXYLAMINE" ;
        skos:prefLabel "DOXYLAMINE" ;
        cco:chemblId "CHEMBL1004" ;
        cco:atcClassification "R06AA09", "R06AA59" ;
        cco:highestDevelopmentPhase 4 ;
        cco:substanceType "Small molecule" ;
        cco:hasActivity chembl_activity:CHEMBL_ACT_5328874 ;
        cco:hasDocument chembl_document:CHEMBL1201862 ;
        cco:hasDrugIndication chembl_drug_indication:CHEMBL_IND_141178 ;
        cco:moleculeXref <http://www.drugbank.ca/drugs/DB00366> ;
        cco:moleculeXref <http://pubchem.ncbi.nlm.nih.gov/compound/3162> ;
        cco:moleculeXref <http://www.ebi.ac.uk/chebi/searchId.do?chebiId=CHEBI%3A51380> ;
        skos:exactMatch <http://purl.obolibrary.org/obo/CHEBI_51380> .
  
  - title: "Bioactivity Measurement"
    description: "An activity record showing Ki binding measurement of 16.7 nM, linking molecule, assay, and document with standardized activity type, value, and units."
    rdf: |
      chembl_activity:CHEMBL_ACT_1000385
        a cco:Activity ;
        cco:chemblId "CHEMBL_ACT_1000385" ;
        cco:standardType "Ki" ;
        cco:standardValue "16.7" ;
        cco:standardUnits "nM" ;
        cco:hasMolecule chembl_molecule:CHEMBL331696 ;
        cco:hasAssay chembl_assay:CHEMBL696974 ;
        rdfs:label "CHEMBL_ACT_1000385" .
  
  - title: "Target with Protein Classification"
    description: "Angiotensin-converting enzyme as a single protein target with organism annotation, showing hierarchical protein classification and links to assays and UniProt."
    rdf: |
      chembl_target:CHEMBL1808
        a cco:SingleProtein ;
        rdfs:label "Angiotensin-converting enzyme" ;
        cco:chemblId "CHEMBL1808" ;
        cco:targetType "SINGLE PROTEIN" ;
        cco:organismName "Homo sapiens" ;
        cco:taxonomy <http://identifiers.org/taxonomy/9606> ;
        cco:hasTargetComponent chembl_target_cmpt:CHEMBL_TC_1332 .
      
      chembl_target_cmpt:CHEMBL_TC_1332
        skos:exactMatch <http://purl.uniprot.org/uniprot/P12527> .
  
  - title: "Drug Mechanism of Action"
    description: "Mechanism record showing an inhibitor relationship between a molecule and target, with mechanismActionType documenting the pharmacological action."
    rdf: |
      chembl_drug_mechanism:CHEMBL_MEC_100
        a cco:Mechanism ;
        rdfs:label "CHEMBL_MEC_100" ;
        cco:mechanismActionType "INHIBITOR" ;
        cco:hasMolecule chembl_molecule:CHEMBL1200475 ;
        cco:hasTarget chembl_target:CHEMBL1806 .
  
  - title: "Drug Indication with Disease Ontology"
    description: "Drug indication for melanoma with development phase 1, linking to MeSH disease terms and EFO ontology for standardized disease representation."
    rdf: |
      chembl_drug_indication:CHEMBL_IND_107436
        a cco:DrugIndication ;
        cco:chemblId "CHEMBL_IND_107436" ;
        cco:hasMolecule chembl_molecule:CHEMBL491473 ;
        cco:hasMeshHeading "Melanoma" ;
        cco:hasMesh <http://identifiers.org/mesh/D008545> ;
        cco:highestDevelopmentPhase 1 ;
        rdfs:label "CHEMBL_IND_107436" .

sparql_query_examples:
  - title: "Keyword Search for Molecules (bif:contains)"
    description: "Search molecules by name using Virtuoso's efficient text search with relevance ranking"
    question: "Find molecules containing 'aspirin' in their name"
    complexity: basic
    sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      SELECT ?molecule ?label
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?molecule a cco:SmallMolecule ;
          rdfs:label ?label .
        ?label bif:contains "'aspirin'" option (score ?sc)
      }
      ORDER BY DESC(?sc)
      LIMIT 100
  
  - title: "Get Targets by Organism"
    description: "Find all human protein targets"
    question: "What are the human protein targets in ChEMBL?"
    complexity: basic
    sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      SELECT ?target ?label ?targetType
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?target a cco:SingleProtein ;
          rdfs:label ?label ;
          cco:targetType ?targetType ;
          cco:organismName "Homo sapiens" .
      }
      LIMIT 100
  
  - title: "Find Bioactivities for a Specific Molecule"
    description: "Retrieve activity measurements with assay information for a compound"
    question: "What are the bioactivities measured for CHEMBL1004?"
    complexity: intermediate
    sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      SELECT ?activity ?type ?value ?units ?assay ?target
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?activity a cco:Activity ;
          cco:hasMolecule <http://rdf.ebi.ac.uk/resource/chembl/molecule/CHEMBL1004> ;
          cco:standardType ?type ;
          cco:hasAssay ?assay .
        ?assay cco:hasTarget ?target .
        OPTIONAL { ?activity cco:standardValue ?value }
        OPTIONAL { ?activity cco:standardUnits ?units }
      }
      LIMIT 100
  
  - title: "Keyword Search on Targets with Boolean Operators"
    description: "Find serine/threonine kinases excluding tyrosine kinases using Boolean NOT"
    question: "Find kinase targets that are not tyrosine kinases"
    complexity: intermediate
    sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      SELECT ?target ?label
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?target a cco:SingleProtein ;
          rdfs:label ?label ;
          cco:organismName "Homo sapiens" .
        ?label bif:contains "('kinase' AND NOT 'tyrosine')" option (score ?sc)
      }
      ORDER BY DESC(?sc)
      LIMIT 100
  
  - title: "Retrieve Drug Indications with Development Phase"
    description: "Get disease indications for molecules showing clinical development progress"
    question: "What are the drug indications for molecules in clinical trials?"
    complexity: intermediate
    sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      SELECT ?molecule ?moleculeLabel ?disease ?phase
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?indication a cco:DrugIndication ;
          cco:hasMolecule ?molecule ;
          cco:hasMeshHeading ?disease ;
          cco:highestDevelopmentPhase ?phase .
        ?molecule rdfs:label ?moleculeLabel .
        FILTER(?phase >= 3)
      }
      ORDER BY DESC(?phase)
      LIMIT 100
  
  - title: "Complex Target-Activity Query with Filtering"
    description: "Find potent inhibitors (IC50 < 100 nM) tested against kinase targets with keyword search"
    question: "What are potent kinase inhibitors?"
    complexity: advanced
    sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
      
      SELECT ?molecule ?label ?target ?targetLabel ?value ?units
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?activity a cco:Activity ;
          cco:standardType "IC50" ;
          cco:standardValue ?value ;
          cco:standardUnits "nM" ;
          cco:hasMolecule ?molecule ;
          cco:hasAssay ?assay .
        ?assay cco:hasTarget ?target .
        ?target cco:hasProteinClassification ?protClass ;
          rdfs:label ?targetLabel .
        ?protClass skos:prefLabel ?className .
        ?molecule rdfs:label ?label .
        ?className bif:contains "'kinase'" option (score ?sc)
        FILTER(xsd:decimal(?value) < 100)
      }
      ORDER BY DESC(?sc)
      LIMIT 100
  
  - title: "Multi-Database Cross-Reference Query"
    description: "Find molecules with known DrugBank IDs and their UniProt target mappings"
    question: "How can I link ChEMBL molecules to DrugBank and UniProt?"
    complexity: advanced
    sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
      
      SELECT ?molecule ?moleculeLabel ?drugbankId ?uniprot ?targetLabel
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?molecule a cco:SmallMolecule ;
          rdfs:label ?moleculeLabel ;
          cco:moleculeXref ?drugbankId ;
          cco:hasActivity ?activity .
        ?activity cco:hasAssay ?assay .
        ?assay cco:hasTarget ?target .
        ?target cco:hasTargetComponent ?targetComponent ;
          rdfs:label ?targetLabel .
        ?targetComponent skos:exactMatch ?uniprot .
        FILTER(STRSTARTS(STR(?drugbankId), "http://www.drugbank.ca/drugs/"))
        FILTER(STRSTARTS(STR(?uniprot), "http://purl.uniprot.org/uniprot/"))
      }
      LIMIT 100

cross_references:
  - pattern: cco:moleculeXref
    description: |
      Molecules link to external databases via cco:moleculeXref using database-specific URI patterns.
      Coverage varies by database; PubChem and ZINC have highest coverage for small molecules.
    databases:
      Chemical:
        - PubChem: 2.2M+ molecules
        - ZINC: 1.2M+ molecules
        - ChEBI: 35k molecules
        - Emolecules: 470k molecules
        - MolPort: 550k molecules
        - Mcule: 490k molecules
      Drug & Pharma:
        - DrugBank: 8.4k molecules
        - FDA SRS: 32k molecules
        - PharmGKB: available
        - HMDB: 12k molecules
      Research:
        - LINCS: 16k molecules
        - SureChEMBL: 540k molecules
        - Wikipedia: available
        - NMRShiftDB2: 41k molecules
    sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      
      SELECT ?molecule ?xref
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?molecule a cco:SmallMolecule ;
          cco:moleculeXref ?xref .
        FILTER(STRSTARTS(STR(?xref), "http://www.drugbank.ca/drugs/"))
      }
      LIMIT 100
  
  - pattern: skos:exactMatch (TargetComponent to UniProt)
    description: |
      Target components link to UniProt proteins via skos:exactMatch, enabling integration with 
      protein sequence and functional annotation data.
    databases:
      Protein:
        - UniProt: 11k target components
        - Ensembl: available
        - PDB: 64k cross-references
    sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
      
      SELECT ?targetComponent ?uniprot
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?targetComponent a cco:TargetComponent ;
          skos:exactMatch ?uniprot .
        FILTER(STRSTARTS(STR(?uniprot), "http://purl.uniprot.org/uniprot/"))
      }
      LIMIT 100
  
  - pattern: cco:hasMesh / cco:hasEFO (Drug Indications)
    description: |
      Drug indications link to disease ontologies via MeSH and EFO, providing standardized disease 
      terminology for indication data.
    databases:
      Disease Ontologies:
        - MeSH: all 51k indications
        - EFO: subset of indications
    sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      
      SELECT ?indication ?mesh ?meshHeading ?efo
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?indication a cco:DrugIndication ;
          cco:hasMesh ?mesh ;
          cco:hasMeshHeading ?meshHeading .
        OPTIONAL { ?indication cco:hasEFO ?efo }
      }
      LIMIT 100
  
  - pattern: bibo:pmid (Documents)
    description: |
      Scientific publications link to PubMed via bibo:pmid property, enabling literature tracking.
    databases:
      Literature:
        - PubMed: majority of 88k documents
        - DOI: majority of documents
    sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX bibo: <http://purl.org/ontology/bibo/>
      
      SELECT ?document ?pmid ?doi
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?document a cco:Document ;
          bibo:pmid ?pmid .
        OPTIONAL { ?document bibo:doi ?doi }
      }
      LIMIT 100
  
  - pattern: cco:taxonomy (Organisms)
    description: |
      Targets, assays, and cell lines link to NCBI Taxonomy for organism information.
    databases:
      Taxonomy:
        - NCBI Taxonomy: extensive coverage
    sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      
      SELECT ?target ?organism ?taxonomy
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?target a cco:SingleProtein ;
          cco:organismName ?organism ;
          cco:taxonomy ?taxonomy .
      }
      LIMIT 100

architectural_notes:
  schema_design:
    - Molecule-Activity-Assay-Target forms the core data model for bioactivity measurements
    - Hierarchical protein classification using SKOS (skos:broader/narrower) enables browsing by protein family
    - TargetComponent serves as bridge entity connecting Targets to external protein identifiers (UniProt)
    - Drug mechanisms separate molecular interactions from bioactivities, linking molecules to targets with action types
    - Documents use BIBO ontology for bibliographic data, connecting to PubMed via identifiers.org URIs
    - Chemical descriptors stored as separate entities (cheminf:CHEMINF_*) linked via sio:SIO_000008
  performance:
    - Always specify FROM graph clause or use GRAPH for better performance
    - Use bif:contains for keyword searches instead of FILTER with REGEX or CONTAINS - it's Virtuoso-optimized
    - The score variable in bif:contains (option (score ?sc)) enables relevance ranking
    - Boolean operators in bif:contains work efficiently (AND, OR, NOT with proper parentheses)
    - Queries filtering on development phase, assay type, or activity type are well-indexed
    - Target-centric queries benefit from starting with target types (SingleProtein, ProteinComplex)
    - Numeric filters on activity values work efficiently when combined with activity type
  data_integration:
    - UniProt mappings via TargetComponent enable protein sequence and function queries
    - PubChem/DrugBank/ChEBI cross-references support chemical structure and property enrichment
    - MeSH/EFO links enable disease ontology-based queries for drug indications
    - NCBI Taxonomy IDs support organism-specific filtering across entities
    - PubMed links enable literature-based filtering and citation analysis
  data_quality:
    - Not all molecules have chemical structure descriptors (InChI, SMILES)
    - Activity values may lack units or use non-standard units (check cco:standardUnits)
    - Some targets lack UniProt mappings, particularly for non-human organisms
    - Development phase data is most complete for marketed drugs (phase 4)
    - Assay confidence scores (cco:targetConfScore) indicate target assignment reliability

data_statistics:
  total_molecules: ~2400000
  total_activities: ~20000000
  total_assays: ~1600000
  total_targets: ~13000
  total_documents: ~88000
  total_drug_indications: ~51000
  coverage:
    molecules_with_activities: "~80%"
    targets_with_uniprot: "~85%"
    activities_with_standard_values: "~70%"
    molecules_with_pubchem: "~90%"
    molecules_with_development_phase: "~5%"
  cardinality:
    avg_activities_per_molecule: 8.5
    avg_assays_per_target: 120
    avg_xrefs_per_molecule: 4.2
  performance_characteristics:
    - Simple molecule/target lookups: <1s for 100 results
    - Activity queries with filters: 2-5s for complex joins
    - Cross-reference queries: 1-3s depending on database
    - Protein classification traversal: efficient with LIMIT
    - Keyword search with bif:contains: very fast with relevance ranking
  data_quality_notes:
    - Activity standardization ensures comparability across assays
    - pChembl values (-log10 of molar IC50/EC50/Ki) enable direct comparison
    - Standard types include IC50, EC50, Ki, Kd, and many others
    - Development phase ranges from 0 (preclinical) to 4 (marketed)

anti_patterns:
  - title: "Using FILTER/REGEX for Text Search Instead of bif:contains"
    problem: "FILTER with REGEX or CONTAINS is slow and not optimized for large text searches"
    wrong_sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      SELECT ?molecule ?label
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?molecule a cco:SmallMolecule ;
          rdfs:label ?label .
        FILTER(REGEX(?label, "kinase", "i"))
      }
      LIMIT 100
    correct_sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      SELECT ?molecule ?label
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?molecule a cco:SmallMolecule ;
          rdfs:label ?label .
        ?label bif:contains "'kinase'" option (score ?sc)
      }
      ORDER BY DESC(?sc)
      LIMIT 100
    explanation: "Use bif:contains for Virtuoso-optimized full-text search with relevance ranking. Supports Boolean operators (AND, OR, NOT) for complex queries."
  
  - title: "Forgetting Activity Units"
    problem: "Comparing activity values without checking units leads to incorrect conclusions"
    wrong_sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      SELECT ?molecule ?value
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?activity cco:hasMolecule ?molecule ;
          cco:standardValue ?value .
        FILTER(xsd:decimal(?value) < 100)
      }
      LIMIT 100
    correct_sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      SELECT ?molecule ?value ?units
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?activity cco:hasMolecule ?molecule ;
          cco:standardValue ?value ;
          cco:standardUnits ?units .
        FILTER(xsd:decimal(?value) < 100 && ?units = "nM")
      }
      LIMIT 100
    explanation: "Always filter by cco:standardUnits when comparing activity values, as values may be in different units (nM, uM, %, etc.)."
  
  - title: "Inefficient Target Component Queries"
    problem: "Querying target components without specifying target type is slow"
    wrong_sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
      SELECT ?component ?uniprot
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?component a cco:TargetComponent ;
          skos:exactMatch ?uniprot .
        FILTER(STRSTARTS(STR(?uniprot), "http://purl.uniprot.org"))
      }
      LIMIT 100
    correct_sparql: |
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX skos: <http://www.w3.org/2004/02/skos/core#>
      SELECT ?target ?component ?uniprot
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?target a cco:SingleProtein ;
          cco:hasTargetComponent ?component .
        ?component skos:exactMatch ?uniprot .
        FILTER(STRSTARTS(STR(?uniprot), "http://purl.uniprot.org/uniprot/"))
      }
      LIMIT 100
    explanation: "Start from specific target types (cco:SingleProtein) and use precise FILTER patterns to improve query performance."

common_errors:
  - error: "Query Timeout"
    causes:
      - Querying without FROM clause or GRAPH specification
      - Using FILTER/REGEX on large text fields instead of bif:contains
      - Missing LIMIT clause on queries returning many results
      - Complex regex patterns on rdfs:label without pre-filtering
    solutions:
      - Always include FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      - Use bif:contains for all text searches instead of FILTER/REGEX/CONTAINS
      - Add specific type constraints (e.g., cco:SmallMolecule) before text filtering
      - Use LIMIT appropriately (typically 100-10000 for exploratory queries)
      - Pre-filter by numeric or categorical properties before text search
    example_fix: |
      # Before (timeout risk):
      SELECT ?molecule ?label
      WHERE {
        ?molecule rdfs:label ?label .
        FILTER(REGEX(?label, "aspirin", "i"))
      }
      
      # After (efficient):
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      SELECT ?molecule ?label
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?molecule a cco:SmallMolecule ;
          rdfs:label ?label .
        ?label bif:contains "'aspirin'" option (score ?sc)
      }
      ORDER BY DESC(?sc)
      LIMIT 100
  
  - error: "Empty Results for Cross-References"
    causes:
      - Using incorrect URI pattern for external database
      - Missing namespace prefixes for cross-reference properties
      - Querying for cross-references on entity types that don't have them
    solutions:
      - Check sample data to confirm exact URI patterns for each database
      - Use STRSTARTS or exact URI matching rather than string patterns
      - Verify entity type supports the cross-reference property (e.g., moleculeXref only on molecules)
      - Use OPTIONAL for cross-references that may not exist for all entities
    example_fix: |
      # Before (may return empty):
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      SELECT ?molecule ?drugbank
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?molecule cco:moleculeXref ?drugbank .
        FILTER(CONTAINS(STR(?drugbank), "drugbank"))
      }
      LIMIT 100
      
      # After (correct):
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      SELECT ?molecule ?drugbank
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?molecule a cco:SmallMolecule ;
          cco:moleculeXref ?drugbank .
        FILTER(STRSTARTS(STR(?drugbank), "http://www.drugbank.ca/drugs/"))
      }
      LIMIT 100
  
  - error: "Incorrect Activity Comparisons"
    causes:
      - Comparing activity values without checking standardType
      - Missing units check leading to mixing nM and uM values
      - Not handling missing values (NULL) in numeric comparisons
    solutions:
      - Always filter by cco:standardType (IC50, EC50, Ki, etc.)
      - Include cco:standardUnits in WHERE clause and filter
      - Use OPTIONAL with FILTER on numeric values to handle missing data
      - Consider using cco:pChembl for normalized comparison across activity types
    example_fix: |
      # Before (incorrect - mixes units and types):
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      SELECT ?molecule ?value
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?activity cco:hasMolecule ?molecule ;
          cco:standardValue ?value .
        FILTER(xsd:decimal(?value) < 100)
      }
      LIMIT 100
      
      # After (correct):
      PREFIX cco: <http://rdf.ebi.ac.uk/terms/chembl#>
      SELECT ?molecule ?type ?value ?units
      FROM <http://rdf.ebi.ac.uk/dataset/chembl>
      WHERE {
        ?activity a cco:Activity ;
          cco:hasMolecule ?molecule ;
          cco:standardType ?type ;
          cco:standardValue ?value ;
          cco:standardUnits ?units .
        FILTER(?type IN ("IC50", "EC50", "Ki"))
        FILTER(?units = "nM")
        FILTER(xsd:decimal(?value) < 100)
      }
      LIMIT 100
schema_info:
  title: NCBI Taxonomy RDF Schema
  description: |
    Comprehensive biological taxonomic classification covering 3M+ organisms from bacteria to mammals. 
    Provides hierarchical relationships from species through genus, family, order, class, phylum, kingdom 
    to superkingdom. Includes scientific names, common names, taxonomic authorities, and genetic code 
    assignments. Extensive cross-references to OBO NCBITaxon, UniProt, NCBI Gene, MBGD, and PubMed databases. 
    Essential for biological data integration and comparative genomics.
  endpoint: https://rdfportal.org/primary/sparql
  base_uri: http://identifiers.org/taxonomy/
  graphs:
    - http://rdfportal.org/ontology/taxonomy

shape_expressions: |
  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
  PREFIX owl: <http://www.w3.org/2002/07/owl#>
  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
  PREFIX dcterms: <http://purl.org/dc/terms/>
  PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
  PREFIX tio: <http://togoid.dbcls.jp/ontology#>
  
  <Taxon> {
    a [ tax:Taxon ] ;
    rdfs:label xsd:string ;
    dcterms:identifier xsd:string ;
    tax:rank @<Rank> ;
    rdfs:subClassOf @<Taxon> * ;
    owl:sameAs IRI * ;
    rdfs:seeAlso IRI * ;
    tax:scientificName xsd:string ? ;
    tax:authority xsd:string ? ;
    tax:genbankCommonName xsd:string ? ;
    tax:commonName xsd:string * ;
    tax:synonym xsd:string * ;
    tax:uniqueName xsd:string ? ;
    tax:geneticCode @<GeneticCode> ? ;
    tax:geneticCodeMt @<GeneticCode> ? ;
    tio:TIO_000002 IRI * ;                      # MBGD organism links
    tio:TIO_000065 IRI * ;                      # NCBI Gene links
    tio:TIO_000032 IRI *                        # PubMed literature links
  }
  
  <Rank> {
    a [ tax:Rank ] ;
    rdfs:label xsd:string
  }
  
  <GeneticCode> {
    rdfs:label xsd:string
  }

sample_rdf_entries:
  - title: Human Species with Complete Metadata
    description: Homo sapiens showing hierarchy and cross-references
    rdf: |
      taxon:9606 a tax:Taxon ;
        rdfs:label "Homo sapiens" ;
        rdfs:subClassOf taxon:9605 ;
        dcterms:identifier "9606" ;
        tax:rank tax:Species ;
        tax:scientificName "Homo sapiens" ;
        tax:authority "Homo sapiens Linnaeus, 1758" ;
        tax:genbankCommonName "human" ;
        tax:commonName "human" ;
        tax:geneticCode tax:GeneticCode1 ;
        tax:geneticCodeMt tax:GeneticCode2 ;
        owl:sameAs obo:NCBITaxon_9606 .
  
  - title: Bacterial Strain Entry
    description: Shigella flexneri strain with gene cross-references
    rdf: |
      taxon:1086030 a tax:Taxon ;
        rdfs:label "Shigella flexneri 5a str. M90T" ;
        rdfs:subClassOf taxon:623 ;
        dcterms:identifier "1086030" ;
        tax:rank tax:Strain ;
        tax:scientificName "Shigella flexneri 5a str. M90T" ;
        tio:TIO_000065 <http://identifiers.org/ncbigene/40047288> .
  
  - title: Genus Level Classification
    description: Escherichia genus showing genus rank
    rdf: |
      taxon:561 a tax:Taxon ;
        rdfs:label "Escherichia" ;
        rdfs:subClassOf taxon:543 ;
        dcterms:identifier "561" ;
        tax:rank tax:Genus ;
        tax:scientificName "Escherichia" .
  
  - title: Kingdom Level
    description: Animal kingdom (Metazoa) high-level classification
    rdf: |
      taxon:33208 a tax:Taxon ;
        rdfs:label "Metazoa" ;
        rdfs:subClassOf taxon:2759 ;
        dcterms:identifier "33208" ;
        tax:rank tax:Kingdom ;
        tax:scientificName "Metazoa" ;
        tax:commonName "animals" .
  
  - title: Root of Taxonomy Tree
    description: Top-level root node
    rdf: |
      taxon:1 a tax:Taxon ;
        rdfs:label "root" ;
        dcterms:identifier "1" ;
        tax:rank tax:NoRank .

sparql_query_examples:
  - title: Search Taxa by Name
    description: Find taxonomy IDs by filtering with scientific or common names
    question: Which taxonomy IDs match organisms with "mouse" in their names?
    complexity: basic
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      SELECT ?taxon ?id ?label ?commonName
      WHERE {
        ?taxon a tax:Taxon ;
               rdfs:label ?label ;
               dcterms:identifier ?id .
        OPTIONAL { ?taxon tax:commonName ?commonName }
        FILTER(CONTAINS(LCASE(?label), "mouse") || CONTAINS(LCASE(?commonName), "mouse"))
      }
      LIMIT 20
  
  - title: Get Biological Annotations for Taxonomy IDs
    description: Retrieve complete biological annotations for specific taxonomy IDs
    question: What are the biological annotations for taxonomy IDs 9606 and 10090?
    complexity: basic
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX taxon: <http://identifiers.org/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      SELECT ?taxon ?label ?id ?rank ?scientificName ?authority ?commonName ?geneticCode
      WHERE {
        VALUES ?taxon { taxon:9606 taxon:10090 }
        ?taxon a tax:Taxon ;
               rdfs:label ?label ;
               dcterms:identifier ?id ;
               tax:rank ?rank .
        OPTIONAL { ?taxon tax:scientificName ?scientificName }
        OPTIONAL { ?taxon tax:authority ?authority }
        OPTIONAL { ?taxon tax:commonName ?commonName }
        OPTIONAL { ?taxon tax:geneticCode ?geneticCode }
      }
  
  - title: Get Complete Lineage
    description: Retrieve full taxonomic lineage for an organism
    question: What is the complete lineage of humans?
    complexity: intermediate
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX taxon: <http://identifiers.org/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      SELECT ?ancestor ?rank ?label ?id
      WHERE {
        taxon:9606 rdfs:subClassOf* ?ancestor .
        ?ancestor a tax:Taxon ;
                  tax:rank ?rank ;
                  rdfs:label ?label ;
                  dcterms:identifier ?id .
      }
      ORDER BY DESC(?id)
  
  - title: Find Species in Genus
    description: Get all species within a specific genus
    question: What species are in genus Escherichia?
    complexity: intermediate
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      SELECT ?species ?label ?id
      WHERE {
        ?species a tax:Taxon ;
                 rdfs:label ?label ;
                 dcterms:identifier ?id ;
                 tax:rank tax:Species ;
                 rdfs:subClassOf ?genus .
        ?genus rdfs:label "Escherichia" ;
               tax:rank tax:Genus .
      }
      LIMIT 20
  
  - title: Find Organisms with Genetic Codes
    description: Get organisms with genetic code assignments
    question: Which organisms have genetic codes?
    complexity: intermediate
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      SELECT ?taxon ?label ?genetic_code ?mt_code
      WHERE {
        ?taxon a tax:Taxon ;
               rdfs:label ?label ;
               tax:geneticCode ?genetic_code .
        OPTIONAL { ?taxon tax:geneticCodeMt ?mt_code }
      }
      LIMIT 20
  
  - title: Count Species Per Genus
    description: Biodiversity analysis counting species in genera
    question: Which genera have most species?
    complexity: advanced
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      SELECT ?genus ?genus_label (COUNT(?species) AS ?count)
      WHERE {
        ?species a tax:Taxon ;
                 tax:rank tax:Species ;
                 rdfs:subClassOf ?genus .
        ?genus tax:rank tax:Genus ;
               rdfs:label ?genus_label .
      }
      GROUP BY ?genus ?genus_label
      ORDER BY DESC(?count)
      LIMIT 20
  
  - title: Explore Taxonomic Hierarchy Depth
    description: Analyze hierarchy depth and rank distribution across lineages
    question: What is the hierarchy depth from species to superkingdom?
    complexity: advanced
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX taxon: <http://identifiers.org/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      SELECT ?species ?species_label (COUNT(?ancestor) as ?depth)
      WHERE {
        ?species a tax:Taxon ;
                 tax:rank tax:Species ;
                 rdfs:label ?species_label ;
                 rdfs:subClassOf+ ?ancestor .
        ?ancestor tax:rank ?rank .
        FILTER(?rank IN (tax:Genus, tax:Family, tax:Order, tax:Class, tax:Phylum, tax:Kingdom, tax:Superkingdom))
      }
      GROUP BY ?species ?species_label
      ORDER BY DESC(?depth)
      LIMIT 20

cross_references:
  - pattern: owl:sameAs
    description: |
      Taxonomic identifier equivalences across multiple ontology and database systems.
      All taxa have owl:sameAs links to ensure interoperability. Distinguished by URL patterns.
    databases:
      ontologies:
        - OBO Library NCBITaxon (purl.obolibrary.org/obo/NCBITaxon_): Primary ontology format, ~100% coverage
        - OBO OWL NCBITaxon (purl.org/obo/owl/NCBITaxon#): Alternative OWL format, ~100% coverage
        - Berkeley BOP NCBITaxon (www.berkeleybop.org/ontologies/owl/NCBITaxon#): BOP ontology format, ~100% coverage
      databases:
        - DDBJ Taxonomy (ddbj.nig.ac.jp/ontologies/taxonomy/): DDBJ native format, ~100% coverage
        - NCBI Taxonomy Web (www.ncbi.nlm.nih.gov/taxonomy/): NCBI web interface, ~100% coverage
    complexity: basic
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX owl: <http://www.w3.org/2002/07/owl#>
      SELECT ?taxon ?label ?sameAs
      WHERE {
        ?taxon a tax:Taxon ;
               rdfs:label ?label ;
               owl:sameAs ?sameAs .
        # Filter for specific database by URL pattern:
        # FILTER(CONTAINS(STR(?sameAs), "obolibrary.org/obo/NCBITaxon"))  # OBO Library
        # FILTER(CONTAINS(STR(?sameAs), "ncbi.nlm.nih.gov/taxonomy"))     # NCBI Web
        # FILTER(CONTAINS(STR(?sameAs), "berkeleybop.org"))               # Berkeley BOP
        # FILTER(CONTAINS(STR(?sameAs), "ddbj.nig.ac.jp"))                # DDBJ
        # FILTER(CONTAINS(STR(?sameAs), "purl.org/obo/owl/NCBITaxon"))    # OBO OWL
      }
      LIMIT 30
  
  - pattern: rdfs:seeAlso
    description: |
      Related resource links pointing to external database entries.
      Currently links to UniProt Taxonomy for protein database integration.
    databases:
      protein_databases:
        - UniProt Taxonomy (purl.uniprot.org/taxonomy/): ~100% coverage
    complexity: basic
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      SELECT ?taxon ?label ?seeAlso
      WHERE {
        ?taxon a tax:Taxon ;
               rdfs:label ?label ;
               rdfs:seeAlso ?seeAlso .
        # Filter for UniProt:
        # FILTER(CONTAINS(STR(?seeAlso), "purl.uniprot.org/taxonomy"))
      }
      LIMIT 30
  
  - pattern: tio:TIO_000002
    description: |
      Links to MBGD (Microbial Genome Database) organism entries via TogoID ontology.
      Limited to organisms with sequenced genomes in MBGD, primarily bacteria and archaea.
    databases:
      comparative_genomics:
        - MBGD (mbgd.genome.ad.jp/rdf/resource/organism/): Limited coverage, sequenced genomes only
    complexity: basic
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX tio: <http://togoid.dbcls.jp/ontology#>
      SELECT ?taxon ?label ?mbgd
      WHERE {
        ?taxon a tax:Taxon ;
               rdfs:label ?label ;
               tio:TIO_000002 ?mbgd .
      }
      LIMIT 30
  
  - pattern: tio:TIO_000065
    description: |
      Links to NCBI Gene database entries via TogoID ontology.
      Coverage varies by organism; well-studied model organisms have extensive gene annotations.
    databases:
      gene_databases:
        - NCBI Gene (identifiers.org/ncbigene/): Variable coverage by organism
    complexity: intermediate
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX tio: <http://togoid.dbcls.jp/ontology#>
      SELECT ?taxon ?label (COUNT(?gene) as ?geneCount)
      WHERE {
        ?taxon a tax:Taxon ;
               rdfs:label ?label ;
               tio:TIO_000065 ?gene .
      }
      GROUP BY ?taxon ?label
      ORDER BY DESC(?geneCount)
      LIMIT 30
  
  - pattern: tio:TIO_000032
    description: |
      Links to PubMed literature via TogoID ontology.
      Limited coverage; primarily for taxa with significant research publications.
    databases:
      literature:
        - PubMed (rdf.ncbi.nlm.nih.gov/pubmed/): Limited coverage, research-intensive organisms
    complexity: basic
    sparql: |
      PREFIX tax: <http://ddbj.nig.ac.jp/ontologies/taxonomy/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      PREFIX tio: <http://togoid.dbcls.jp/ontology#>
      SELECT ?taxon ?label ?pubmed
      WHERE {
        ?taxon a tax:Taxon ;
               rdfs:label ?label ;
               tio:TIO_000032 ?pubmed .
      }
      LIMIT 30

architectural_notes:
  schema_design:
    - Hierarchical classification via rdfs:subClassOf for parent-child relationships
    - Extensive cross-referencing with owl:sameAs for database interoperability
    - Specialized taxonomic properties under tax namespace
    - TogoID integration (tio:TIO_*) for systematic cross-database linking
    - Multiple naming systems (scientific, common, synonym, unique) for diverse contexts
  
  performance:
    - 3M+ taxa require query optimization and LIMIT clauses
    - Hierarchical queries with rdfs:subClassOf* can be expensive on deep lineages
    - Cross-reference queries should be limited to avoid timeout
    - Filtering by tax:rank improves performance for rank-specific queries
    - owl:sameAs queries efficient due to indexing
  
  data_integration:
    - OBO NCBITaxon for ontology interoperability and reasoning
    - UniProt Taxonomy for protein database integration
    - NCBI Gene for gene-level annotations
    - MBGD for comparative genomics (sequenced genomes)
    - PubMed for literature references (research-intensive organisms)
    - TogoID properties enable systematic ID conversion
  
  data_quality:
    - Systematic cross-referencing ensures consistency across databases
    - Authority citations provide taxonomic provenance
    - Multiple naming systems accommodate different research contexts
    - Genetic code assignments reflect biological translation systems
    - All taxa have core identity links (owl:sameAs, rdfs:seeAlso)

data_statistics:
  total_taxa: 3046425
  estimated_species: ~1500000
  estimated_genera: ~200000
  taxonomic_ranks: 47
  
  coverage:
    taxa_with_owl_sameAs: ~100%
    taxa_with_rdfs_seeAlso: ~100%
    taxa_with_scientific_names: ">99%"
    taxa_with_common_names: ~30%
    taxa_with_genetic_codes: ~40%
    taxa_with_mbgd_links: <1%
    taxa_with_ncbi_gene_links: ~5%
    taxa_with_pubmed_links: <1%
  
  cardinality:
    avg_owl_sameAs_per_taxon: 5.0
    max_owl_sameAs_per_taxon: 5
    avg_ncbi_genes_per_taxon: 50-10000
    avg_common_names_per_taxon: 1-3
  
  performance_characteristics:
    - Core identity queries (owl:sameAs, rdfs:seeAlso) are well-optimized
    - Lineage traversal with rdfs:subClassOf* can be slow for deep hierarchies
    - Recommend LIMIT 100 for exploratory queries
    - Tax:rank filtering significantly improves query performance
    - TogoID gene queries may return many results per organism
  
  data_quality_notes:
    - All taxa have complete identity cross-references (owl:sameAs, rdfs:seeAlso)
    - TogoID links vary in completeness based on organism research status
    - MBGD links limited to organisms with complete genome sequences
    - Common names more complete for vertebrates and model organisms
  
  indexed_properties:
    - rdfs:label
    - dcterms:identifier
    - tax:rank
    - rdfs:subClassOf
    - owl:sameAs
  
  most_diverse_genera:
    - Cortinarius (1962 species)
    - Astragalus (1558 species)
    - Megaselia (1284 species)

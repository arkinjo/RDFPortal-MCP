schema_info:
  title: Protein Data Bank (PDB)
  description: |
    Comprehensive 3D structural data repository for proteins, nucleic acids, and complex assemblies determined by X-ray
    crystallography, NMR, cryo-EM, and other methods. Contains 204K+ entries with experimental data, refinement statistics,
    sequence information, and cross-references to UniProt, EMDB, GenBank. Essential for structural biology, drug discovery,
    and understanding biomolecular function. Includes resolution data, R-factors, and quality metrics for structure assessment.
  endpoint: https://rdfportal.org/backend/pdb/sparql
  base_uri: http://rdf.wwpdb.org/pdb/
  graphs:
    - http://rdfportal.org/dataset/pdbj

shape_expressions: |
  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
  PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
  
  <Datablock> {
    a [ pdbx:datablock ] ;
    pdbx:has_entityCategory @<EntityCategory> * ;
    pdbx:has_entity_polyCategory @<EntityPolyCategory> * ;
    pdbx:has_exptlCategory @<ExptlCategory> + ;
    pdbx:has_refineCategory @<RefineCategory> * ;
    pdbx:has_struct_refCategory @<StructRefCategory> * ;
    pdbx:has_database_2Category @<Database2Category> * ;
    pdbx:has_audit_authorCategory @<AuditAuthorCategory> *
  }
  
  <Entity> {
    pdbx:entity.id xsd:string ;
    pdbx:entity.type [ "polymer" "non-polymer" "water" ] ;
    pdbx:entity.pdbx_description xsd:string ? ;
    pdbx:entity.formula_weight xsd:decimal ?
  }
  
  <EntityPoly> {
    pdbx:entity_poly.entity_id xsd:string ;
    pdbx:entity_poly.type xsd:string ;
    pdbx:entity_poly.pdbx_seq_one_letter_code xsd:string ?
  }
  
  <Refine> {
    pdbx:refine.entry_id xsd:string ;
    pdbx:refine.ls_d_res_high xsd:decimal ? ;
    pdbx:refine.ls_R_factor_R_work xsd:decimal ? ;
    pdbx:refine.ls_R_factor_R_free xsd:decimal ?
  }
  
  <Exptl> {
    pdbx:exptl.entry_id xsd:string ;
    pdbx:exptl.method xsd:string
  }
  
  <StructRef> {
    pdbx:struct_ref.entity_id xsd:string ;
    pdbx:struct_ref.db_name xsd:string ;
    pdbx:struct_ref.db_code xsd:string ? ;
    pdbx:struct_ref.pdbx_db_accession xsd:string ?
  }

sample_rdf_entries:
  - title: High Resolution Protein Structure
    description: Crambin at 0.48 Ã… - ultra-high resolution
    rdf: |
      pdb:3NIR a pdbx:datablock ;
        pdbx:has_refineCategory pdb:3NIR/refineCategory .
      pdb:3NIR/refine/3NIR,X-RAY_DIFFRACTION a pdbx:refine ;
        pdbx:refine.entry_id "3NIR" ;
        pdbx:refine.ls_d_res_high "0.48"^^xsd:decimal ;
        pdbx:refine.ls_R_factor_R_work "0.127"^^xsd:decimal .

  - title: DNA Structure Entry
    description: Dickerson DNA dodecamer with sequence
    rdf: |
      pdb:100D/entity/1 a pdbx:entity ;
        pdbx:entity.id "1" ;
        pdbx:entity.type "polymer" ;
        pdbx:entity.pdbx_description "DNA/RNA (5'-R(*CP*)-D(*CP*GP*GP*CP*GP*CP*CP*GP*)-R(*G)-3')" ;
        pdbx:entity.formula_weight "3078.980"^^xsd:decimal .

  - title: Protein with UniProt Reference
    description: Trypanosoma protein with UniProt cross-reference
    rdf: |
      pdb:16PK/struct_ref/1 a pdbx:struct_ref ;
        pdbx:struct_ref.entity_id "1" ;
        pdbx:struct_ref.db_name "UNP" ;
        pdbx:struct_ref.db_code "PGKC_TRYBB" ;
        pdbx:struct_ref.pdbx_db_accession "P07378" .

  - title: Cryo-EM Structure
    description: EM structure with EMDB reference
    rdf: |
      pdb:8A2Z/database_2/1 a pdbx:database_2 ;
        pdbx:database_2.database_id "EMDB" ;
        pdbx:database_2.database_code "EMD-15109" .
      pdb:8A2Z/exptl/1 a pdbx:exptl ;
        pdbx:exptl.entry_id "8A2Z" ;
        pdbx:exptl.method "ELECTRON MICROSCOPY" .

  - title: RNA Structure
    description: RNA hammerhead ribozyme with sequence
    rdf: |
      pdb:300D/entity_poly/1 a pdbx:entity_poly ;
        pdbx:entity_poly.entity_id "1" ;
        pdbx:entity_poly.type "polyribonucleotide" ;
        pdbx:entity_poly.pdbx_seq_one_letter_code "GUGGUCUGAUGAGGCC" .

sparql_query_examples:
  - title: Find Highest Resolution Structures
    description: Retrieve structures with best resolution
    question: What are highest resolution structures?
    complexity: intermediate
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
      SELECT ?entry_id ?resolution ?r_work
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_refineCategory/pdbx:has_refine ?refine .
        ?refine pdbx:refine.ls_d_res_high ?resolution .
        OPTIONAL { ?refine pdbx:refine.ls_R_factor_R_work ?r_work }
        FILTER(xsd:decimal(?resolution) > 0)
      }
      ORDER BY xsd:decimal(?resolution)
      LIMIT 20

  - title: Search Proteins by Name
    description: Find structures by protein description
    question: Find kinase structures
    complexity: basic
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      SELECT ?entry_id ?description
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_entityCategory/pdbx:has_entity ?entity .
        ?entity pdbx:entity.pdbx_description ?description .
        FILTER(CONTAINS(LCASE(?description), "kinase"))
      }
      LIMIT 30

  - title: Get Experimental Methods
    description: Count structures by experimental method
    question: What methods are used most?
    complexity: basic
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      SELECT ?method (COUNT(?method) as ?count)
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry pdbx:has_exptlCategory/pdbx:has_exptl ?exptl .
        ?exptl pdbx:exptl.method ?method .
      }
      GROUP BY ?method
      ORDER BY DESC(?count)

  - title: Find Structures with UniProt
    description: Get protein structures with UniProt links
    question: Which structures have UniProt references?
    complexity: intermediate
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      SELECT ?entry_id ?uniprot_acc
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_struct_refCategory/pdbx:has_struct_ref ?ref .
        ?ref pdbx:struct_ref.db_name "UNP" ;
             pdbx:struct_ref.pdbx_db_accession ?uniprot_acc .
      }
      LIMIT 50

  - title: Analyze Resolution Distribution
    description: Statistical analysis of resolution by method
    question: What is typical resolution per method?
    complexity: advanced
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
      SELECT ?method 
             (AVG(xsd:decimal(?resolution)) as ?avg_res)
             (MIN(xsd:decimal(?resolution)) as ?best_res)
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry pdbx:has_exptlCategory/pdbx:has_exptl ?exptl ;
               pdbx:has_refineCategory/pdbx:has_refine ?refine .
        ?exptl pdbx:exptl.method ?method .
        ?refine pdbx:refine.ls_d_res_high ?resolution .
        FILTER(xsd:decimal(?resolution) > 0 && xsd:decimal(?resolution) < 100)
      }
      GROUP BY ?method

  - title: Find Cryo-EM Structures
    description: Get EM structures with EMDB references
    question: Which cryo-EM structures have EMDB links?
    complexity: intermediate
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      SELECT ?entry_id ?emdb_code
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_database_2Category/pdbx:has_database_2 ?db .
        ?db pdbx:database_2.database_id "EMDB" ;
            pdbx:database_2.database_code ?emdb_code .
        ?entry pdbx:has_exptlCategory/pdbx:has_exptl ?exptl .
        ?exptl pdbx:exptl.method "ELECTRON MICROSCOPY" .
      }
      LIMIT 20

  - title: Find Nucleic Acid Structures
    description: Get DNA/RNA structures with sequences
    question: What nucleic acid structures are available?
    complexity: intermediate
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      SELECT ?entry_id ?poly_type ?sequence
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_entity_polyCategory/pdbx:has_entity_poly ?poly .
        ?poly pdbx:entity_poly.type ?poly_type ;
              pdbx:entity_poly.pdbx_seq_one_letter_code ?sequence .
        FILTER(?poly_type IN ("polyribonucleotide", "polydeoxyribonucleotide"))
        FILTER(STRLEN(?sequence) >= 10)
      }
      LIMIT 20

cross_references:
  - title: UniProt Sequence Links
    description: Cross-reference to UniProt for protein sequences
    complexity: basic
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      SELECT ?entry_id ?uniprot_code ?uniprot_acc
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_struct_refCategory/pdbx:has_struct_ref ?ref .
        ?ref pdbx:struct_ref.db_name "UNP" ;
             pdbx:struct_ref.db_code ?uniprot_code ;
             pdbx:struct_ref.pdbx_db_accession ?uniprot_acc .
      }
      LIMIT 50

  - title: EMDB Electron Microscopy Links
    description: Connect to EMDB for density maps
    complexity: intermediate
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      SELECT ?entry_id ?emdb_code
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_database_2Category/pdbx:has_database_2 ?db .
        ?db pdbx:database_2.database_id "EMDB" ;
            pdbx:database_2.database_code ?emdb_code .
      }
      LIMIT 50

  - title: GenBank Nucleotide Links
    description: Cross-reference to GenBank for DNA/RNA sequences
    complexity: basic
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      SELECT ?entry_id ?genbank_acc
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_struct_refCategory/pdbx:has_struct_ref ?ref .
        ?ref pdbx:struct_ref.db_name "GB" ;
             pdbx:struct_ref.pdbx_db_accession ?genbank_acc .
      }
      LIMIT 50

architectural_notes:
  schema_design:
    - PDBx/mmCIF ontology with Category-Item design pattern
    - Datablock root contains specialized category collections
    - Strong separation between structural data, experiments, refinement, cross-references
    - Consistent URI patterns for federated queries
  
  performance:
    - 204K+ entries with 900K+ entities require optimization
    - Multi-join queries across categories need strategic indexing
    - Resolution queries benefit from numeric filtering
    - Result pagination recommended for large sets
  
  data_integration:
    - UniProt for protein sequences (352K+ refs)
    - EMDB for cryo-EM density maps (15K+ structures)
    - GenBank for nucleotide sequences
    - WWPDB partners for distributed access
    - BMRB for NMR data
  
  data_quality:
    - Resolution and R-factors indicate structure quality
    - Refinement statistics enable quality filtering
    - Cross-references validated against source databases
    - Experimental method documentation comprehensive

data_statistics:
  total_entries: 204594
  total_entities: 900000+
  experimental_methods:
    - X-ray (174K)
    - EM (15K)
    - NMR (14K)
  uniprot_refs: 352114
  
  indexed_properties:
    - pdbx:refine.ls_d_res_high
    - pdbx:exptl.method
    - pdbx:struct_ref.pdbx_db_accession
  
  resolution_extremes:
    best: 0.48 Ã… (5D8V, 3NIR)
    typical_high: 1.0-2.0 Ã…
    typical_medium: 2.0-3.0 Ã…
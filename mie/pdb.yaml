schema_info:
  title: Protein Data Bank (PDB)
  description: |
    Comprehensive 3D structural data repository for proteins, nucleic acids, and complex assemblies determined by X-ray
    crystallography, NMR, cryo-EM, and other methods. Contains 204K+ entries with experimental data, refinement statistics,
    sequence information, and cross-references to UniProt, EMDB, GenBank. Essential for structural biology, drug discovery,
    and understanding biomolecular function. Includes resolution data, R-factors, and quality metrics for structure assessment.
  endpoint: https://rdfportal.org/backend/pdb/sparql
  base_uri: http://rdf.wwpdb.org/pdb/
  graphs:
    - http://rdfportal.org/dataset/pdbj

shape_expressions: |
  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
  PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>

  <Datablock> {
    a [ pdbx:datablock ] ;
    pdbx:has_entityCategory @<EntityCategory> * ;
    pdbx:has_entity_polyCategory @<EntityPolyCategory> * ;
    pdbx:has_exptlCategory @<ExptlCategory> + ;
    pdbx:has_refineCategory @<RefineCategory> * ;
    pdbx:has_struct_refCategory @<StructRefCategory> * ;
    pdbx:has_database_2Category @<Database2Category> * ;
    pdbx:has_citationCategory @<CitationCategory> * ;
    pdbx:has_audit_authorCategory @<AuditAuthorCategory> *
  }

  <Entity> {
    pdbx:entity.id xsd:string ;
    pdbx:entity.type [ "polymer" "non-polymer" "water" ] ;
    pdbx:entity.pdbx_description xsd:string ? ;
    pdbx:entity.formula_weight xsd:decimal ?
  }

  <EntityPoly> {
    pdbx:entity_poly.entity_id xsd:string ;
    pdbx:entity_poly.type xsd:string ;
    pdbx:entity_poly.pdbx_seq_one_letter_code xsd:string ?
  }

  <Refine> {
    pdbx:refine.entry_id xsd:string ;
    pdbx:refine.ls_d_res_high xsd:decimal ? ;
    pdbx:refine.ls_R_factor_R_work xsd:decimal ? ;
    pdbx:refine.ls_R_factor_R_free xsd:decimal ?
  }

  <Exptl> {
    pdbx:exptl.entry_id xsd:string ;
    pdbx:exptl.method xsd:string
  }

  <StructRef> {
    pdbx:struct_ref.entity_id xsd:string ;
    pdbx:struct_ref.db_name xsd:string ;
    pdbx:struct_ref.db_code xsd:string ? ;
    pdbx:struct_ref.pdbx_db_accession xsd:string ?
  }

  <Database2> {
    pdbx:database_2.database_id xsd:string ;
    pdbx:database_2.database_code xsd:string
  }

  <Citation> {
    pdbx:citation.id xsd:string ;
    pdbx:citation.title xsd:string ? ;
    pdbx:citation.pdbx_database_id_DOI xsd:string ? ;
    pdbx:citation.pdbx_database_id_PubMed xsd:string ? ;
    pdbx:link_to_doi IRI ? ;
    pdbx:link_to_pubmed IRI ?
  }

sample_rdf_entries:
  - title: High Resolution Protein Structure
    description: Crambin at 0.48 Ã… - ultra-high resolution
    rdf: |
      pdb:3NIR a pdbx:datablock ;
        pdbx:has_refineCategory pdb:3NIR/refineCategory .
      pdb:3NIR/refine/3NIR,X-RAY_DIFFRACTION a pdbx:refine ;
        pdbx:refine.entry_id "3NIR" ;
        pdbx:refine.ls_d_res_high "0.48"^^xsd:decimal ;
        pdbx:refine.ls_R_factor_R_work "0.127"^^xsd:decimal .

  - title: DNA Structure Entry
    description: Dickerson DNA dodecamer with sequence
    rdf: |
      pdb:100D/entity/1 a pdbx:entity ;
        pdbx:entity.id "1" ;
        pdbx:entity.type "polymer" ;
        pdbx:entity.pdbx_description "DNA/RNA (5'-R(*CP*)-D(*CP*GP*GP*CP*GP*CP*CP*GP*)-R(*G)-3')" ;
        pdbx:entity.formula_weight "3078.980"^^xsd:decimal .

  - title: Protein with UniProt Reference
    description: Trypanosoma protein with UniProt cross-reference
    rdf: |
      pdb:16PK/struct_ref/1 a pdbx:struct_ref ;
        pdbx:struct_ref.entity_id "1" ;
        pdbx:struct_ref.db_name "UNP" ;
        pdbx:struct_ref.db_code "PGKC_TRYBB" ;
        pdbx:struct_ref.pdbx_db_accession "P07378" .

  - title: Cryo-EM Structure
    description: EM structure with EMDB reference
    rdf: |
      pdb:8A2Z/database_2/1 a pdbx:database_2 ;
        pdbx:database_2.database_id "EMDB" ;
        pdbx:database_2.database_code "EMD-15109" .
      pdb:8A2Z/exptl/1 a pdbx:exptl ;
        pdbx:exptl.entry_id "8A2Z" ;
        pdbx:exptl.method "ELECTRON MICROSCOPY" .

  - title: RNA Structure
    description: RNA hammerhead ribozyme with sequence
    rdf: |
      pdb:300D/entity_poly/1 a pdbx:entity_poly ;
        pdbx:entity_poly.entity_id "1" ;
        pdbx:entity_poly.type "polyribonucleotide" ;
        pdbx:entity_poly.pdbx_seq_one_letter_code "GUGGUCUGAUGAGGCC" .

sparql_query_examples:
  - title: Find Highest Resolution Structures
    description: Retrieve structures with best resolution
    question: What are highest resolution structures?
    complexity: intermediate
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
      SELECT ?entry_id ?resolution ?r_work
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_refineCategory/pdbx:has_refine ?refine .
        ?refine pdbx:refine.ls_d_res_high ?resolution .
        OPTIONAL { ?refine pdbx:refine.ls_R_factor_R_work ?r_work }
        FILTER(xsd:decimal(?resolution) > 0)
      }
      ORDER BY xsd:decimal(?resolution)
      LIMIT 20

  - title: Search Proteins by Name
    description: Find structures by protein description
    question: Find kinase structures
    complexity: basic
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      SELECT ?entry_id ?description
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_entityCategory/pdbx:has_entity ?entity .
        ?entity pdbx:entity.pdbx_description ?description .
        FILTER(CONTAINS(LCASE(?description), "kinase"))
      }
      LIMIT 30

  - title: Get Experimental Methods
    description: Count structures by experimental method
    question: What methods are used most?
    complexity: basic
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      SELECT ?method (COUNT(?method) as ?count)
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry pdbx:has_exptlCategory/pdbx:has_exptl ?exptl .
        ?exptl pdbx:exptl.method ?method .
      }
      GROUP BY ?method
      ORDER BY DESC(?count)

  - title: Find Structures with UniProt
    description: Get protein structures with UniProt links
    question: Which structures have UniProt references?
    complexity: intermediate
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      SELECT ?entry_id ?uniprot_acc
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_struct_refCategory/pdbx:has_struct_ref ?ref .
        ?ref pdbx:struct_ref.db_name "UNP" ;
             pdbx:struct_ref.pdbx_db_accession ?uniprot_acc .
      }
      LIMIT 50

  - title: Analyze Resolution Distribution
    description: Statistical analysis of resolution by method
    question: What is typical resolution per method?
    complexity: advanced
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
      SELECT ?method 
             (AVG(xsd:decimal(?resolution)) as ?avg_res)
             (MIN(xsd:decimal(?resolution)) as ?best_res)
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry pdbx:has_exptlCategory/pdbx:has_exptl ?exptl ;
               pdbx:has_refineCategory/pdbx:has_refine ?refine .
        ?exptl pdbx:exptl.method ?method .
        ?refine pdbx:refine.ls_d_res_high ?resolution .
        FILTER(xsd:decimal(?resolution) > 0 && xsd:decimal(?resolution) < 100)
      }
      GROUP BY ?method

  - title: Find Cryo-EM Structures
    description: Get EM structures with EMDB references
    question: Which cryo-EM structures have EMDB links?
    complexity: intermediate
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      SELECT ?entry_id ?emdb_code
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_database_2Category/pdbx:has_database_2 ?db .
        ?db pdbx:database_2.database_id "EMDB" ;
            pdbx:database_2.database_code ?emdb_code .
        ?entry pdbx:has_exptlCategory/pdbx:has_exptl ?exptl .
        ?exptl pdbx:exptl.method "ELECTRON MICROSCOPY" .
      }
      LIMIT 20

  - title: Find Nucleic Acid Structures
    description: Get DNA/RNA structures with sequences
    question: What nucleic acid structures are available?
    complexity: intermediate
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      SELECT ?entry_id ?poly_type ?sequence
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_entity_polyCategory/pdbx:has_entity_poly ?poly .
        ?poly pdbx:entity_poly.type ?poly_type ;
              pdbx:entity_poly.pdbx_seq_one_letter_code ?sequence .
        FILTER(?poly_type IN ("polyribonucleotide", "polydeoxyribonucleotide"))
        FILTER(STRLEN(?sequence) >= 10)
      }
      LIMIT 20

cross_references:
  - pattern: pdbx:struct_ref
    description: |
      Sequence database cross-references via pdbx:struct_ref. Each reference includes db_name (database identifier),
      db_code (entry name/mnemonic), and pdbx_db_accession (accession number). Entities can have multiple references.
      Properties: pdbx:struct_ref.db_name, pdbx:struct_ref.db_code, pdbx:struct_ref.pdbx_db_accession, pdbx:struct_ref.entity_id
    databases:
      protein_sequences:
        - UNP (UniProt): 352,114 refs (~172% coverage - multiple per entry)
        - PIR (Protein Information Resource): 131 refs
        - TREMBL (TrEMBL): 4 refs
        - PRF (Protein Research Foundation): 2 refs
      nucleotide_sequences:
        - GB (GenBank): 5,874 refs
        - EMBL (European Nucleotide Archive): 84 refs
        - REF (RefSeq): 49 refs
      other:
        - PDB (self-references): 71,459 refs
        - NOR: 227 refs
        - TPG: 36 refs
        - GENP: 1 ref
        - NDB (Nucleic Acid Database): 1 ref
    complexity: basic
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      SELECT ?entry_id ?db_name ?db_code ?db_accession ?entity_id
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_struct_refCategory/pdbx:has_struct_ref ?ref .
        ?ref pdbx:struct_ref.db_name ?db_name ;
             pdbx:struct_ref.entity_id ?entity_id .
        OPTIONAL { ?ref pdbx:struct_ref.db_code ?db_code }
        OPTIONAL { ?ref pdbx:struct_ref.pdbx_db_accession ?db_accession }
        # Filter examples for specific databases:
        # FILTER(?db_name = "UNP")                    # UniProt only
        # FILTER(?db_name = "GB")                     # GenBank only
        # FILTER(?db_name IN ("GB", "EMBL", "REF"))   # All nucleotide DBs
      }
      LIMIT 30

  - pattern: pdbx:database_2
    description: |
      External database links via pdbx:database_2. Includes WWPDB partners, electron microscopy, NMR, and other repositories.
      Every entry has PDB and WWPDB references (100% coverage). Use database_id to filter specific databases.
      Properties: pdbx:database_2.database_id, pdbx:database_2.database_code
    databases:
      wwpdb_partners:
        - PDB: 204,375 refs (100% coverage)
        - WWPDB (Worldwide PDB): 204,375 refs (100% coverage)
        - RCSB (RCSB PDB): 83,418 refs (~41% coverage)
        - PDBE (PDB Europe): 16,991 refs (~8% coverage)
      structure_repositories:
        - EMDB (Electron Microscopy Data Bank): 13,974 refs (~7% coverage)
        - BMRB (Biological Magnetic Resonance Bank): 5,956 refs (~3% coverage)
        - NDB (Nucleic Acid Database): 4,565 refs (~2% coverage)
    complexity: basic
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      SELECT ?entry_id ?db_id ?db_code
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_database_2Category/pdbx:has_database_2 ?db .
        ?db pdbx:database_2.database_id ?db_id ;
            pdbx:database_2.database_code ?db_code .
        # Filter examples for specific databases:
        # FILTER(?db_id = "EMDB")                     # EMDB only
        # FILTER(?db_id = "BMRB")                     # BMRB only (NMR data)
        # FILTER(?db_id IN ("RCSB", "PDBE"))          # Specific mirrors
      }
      LIMIT 30

  - pattern: pdbx:citation
    description: |
      Publication references via pdbx:citation. Most entries have DOI (~75%) and/or PubMed (~73%) identifiers.
      Citations also include journal information, title, authors, and structured bibliographic metadata.
      Properties: pdbx:citation.pdbx_database_id_DOI, pdbx:citation.pdbx_database_id_PubMed, pdbx:link_to_doi, pdbx:link_to_pubmed
    databases:
      publications:
        - DOI (Digital Object Identifier): 186,683 refs (~75% coverage)
        - PubMed: 181,261 refs (~73% coverage)
    complexity: basic
    sparql: |
      PREFIX pdbx: <http://rdf.wwpdb.org/schema/pdbx-v50.owl#>
      PREFIX dcterms: <http://purl.org/dc/terms/>
      SELECT ?entry_id ?doi ?pubmed ?title
      FROM <http://rdfportal.org/dataset/pdbj>
      WHERE {
        ?entry a pdbx:datablock .
        BIND(STRAFTER(str(?entry), "http://rdf.wwpdb.org/pdb/") AS ?entry_id)
        ?entry pdbx:has_citationCategory/pdbx:has_citation ?citation .
        OPTIONAL { 
          ?citation pdbx:citation.pdbx_database_id_DOI ?doi .
        }
        OPTIONAL { 
          ?citation pdbx:citation.pdbx_database_id_PubMed ?pubmed .
        }
        OPTIONAL { ?citation pdbx:citation.title ?title }
        FILTER(BOUND(?doi) || BOUND(?pubmed))
      }
      LIMIT 20

architectural_notes:
  schema_design:
    - PDBx/mmCIF ontology with Category-Item design pattern
    - Datablock root contains specialized category collections
    - Strong separation between structural data, experiments, refinement, cross-references
    - Consistent URI patterns for federated queries
  
  performance:
    - 204K+ entries with 900K+ entities require optimization
    - Multi-join queries across categories need strategic indexing
    - Resolution queries benefit from numeric filtering
    - Result pagination recommended for large sets
  
  data_integration:
    - UniProt for protein sequences (352K+ refs, ~172% coverage)
    - EMDB for cryo-EM density maps (14K+ structures, ~7% coverage)
    - GenBank/EMBL/RefSeq for nucleotide sequences (6K+ refs)
    - WWPDB partners (RCSB, PDBE) for distributed access
    - BMRB for NMR data (~3% coverage)
    - DOI/PubMed for publications (~75%/73% coverage)
  
  data_quality:
    - Resolution and R-factors indicate structure quality
    - Refinement statistics enable quality filtering
    - Cross-references validated against source databases
    - Experimental method documentation comprehensive
    - Multiple references per entity common for UniProt

data_statistics:
  total_entries: 204594
  total_entities: 900000+
  experimental_methods:
    - X-ray (174K, ~85%)
    - EM (15K, ~7%)
    - NMR (14K, ~7%)
  
  coverage:
    entries_with_uniprot_refs: "~172% (multiple per entry)"
    entries_with_emdb_refs: "~7%"
    entries_with_genbank_refs: "~3%"
    entries_with_doi: "~75%"
    entries_with_pubmed: "~73%"
    entries_with_bmrb: "~3%"
    entries_with_resolution_data: ">85% (X-ray and some EM)"
  
  cardinality:
    avg_uniprot_refs_per_entry: 1.72
    avg_entities_per_entry: 4.4
    max_entities_per_entry: 100+
  
  cross_reference_counts:
    uniprot: 352114
    pdb_self_ref: 71459
    genbank: 5874
    emdb: 13974
    bmrb: 5956
    ndb: 4565
    doi: 186683
    pubmed: 181261
  
  indexed_properties:
    - pdbx:refine.ls_d_res_high
    - pdbx:exptl.method
    - pdbx:struct_ref.pdbx_db_accession
    - pdbx:struct_ref.db_name
    - pdbx:database_2.database_id
  
  resolution_extremes:
    best: "0.48 Ã… (5D8V, 3NIR)"
    typical_high: "1.0-2.0 Ã…"
    typical_medium: "2.0-3.0 Ã…"
  
  performance_characteristics:
    - Resolution queries efficient with numeric filters
    - Cross-reference queries by db_name/db_id work well
    - Multi-category joins benefit from filtering on entry_id first
    - Text search on descriptions should use CONTAINS/LCASE
    - Recommend LIMIT 30-100 for exploratory queries
  
  data_quality_notes:
    - UniProt references may have multiple entries per structure entity
    - Not all entries have resolution data (NMR structures lack this)
    - Cross-reference coverage varies significantly by database
    - Some older entries may have incomplete external links

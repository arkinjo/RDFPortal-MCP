schema_info:
  title: PubChem RDF
  description: |
    PubChem is a comprehensive public database of chemical molecules and their biological activities, 
    maintained by the National Center for Biotechnology Information (NCBI). PubChem RDF provides structured 
    linked data covering compounds (identified by CID), substances (SID), bioassays (AID), and their 
    relationships. The database includes rich molecular descriptors (SMILES, InChI, physicochemical properties), 
    extensive cross-references to chemical ontologies (ChEBI, SNOMED CT, NCI Thesaurus), patent information, 
    drug classifications, stereoisomer relationships, and bioactivity data. PubChem serves as a central hub 
    for chemical information integration, connecting molecular structures to biological activities, patents, 
    and external knowledge bases.
  endpoint: https://rdfportal.org/backend/pubchem/sparql
  base_uri: http://rdf.ncbi.nlm.nih.gov/pubchem/
  graphs:
    - http://rdf.ncbi.nlm.nih.gov/pubchem/compound
    - http://rdf.ncbi.nlm.nih.gov/pubchem/substance
    - http://rdf.ncbi.nlm.nih.gov/pubchem/bioassay
    - http://rdf.ncbi.nlm.nih.gov/pubchem/descriptor/compound
    - http://rdf.ncbi.nlm.nih.gov/pubchem/descriptor/substance
    - http://rdf.ncbi.nlm.nih.gov/pubchem/patent
    - http://rdf.ncbi.nlm.nih.gov/pubchem/protein
    - http://rdf.ncbi.nlm.nih.gov/pubchem/gene
    - http://rdf.ncbi.nlm.nih.gov/pubchem/inchikey
    - http://rdf.ncbi.nlm.nih.gov/pubchem/taxonomy

shape_expressions: |
  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
  PREFIX xsd: <http://www.w3.org/2001/XMLSchema#>
  PREFIX sio: <http://semanticscience.org/resource/>
  PREFIX cheminf: <http://semanticscience.org/resource/>
  PREFIX vocab: <http://rdf.ncbi.nlm.nih.gov/pubchem/vocabulary#>
  PREFIX obo: <http://purl.obolibrary.org/obo/>
  PREFIX cito: <http://purl.org/spar/cito/>
  PREFIX compound: <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/>
  PREFIX substance: <http://rdf.ncbi.nlm.nih.gov/pubchem/substance/>
  PREFIX bioassay: <http://rdf.ncbi.nlm.nih.gov/pubchem/bioassay/>
  PREFIX bao: <http://www.bioassayontology.org/bao#>
  
  <CompoundShape> {
    a [ vocab:Compound ] ;
    a IRI* ;                                      # Ontology mappings (CHEBI, SNOMEDCT, NCI)
    sio:SIO_000008 @<DescriptorShape>* ;
    cheminf:CHEMINF_000455 @<CompoundShape>* ;   # Stereoisomer relationships
    obo:RO_0000087 IRI* ;                        # Chemical/drug roles (e.g., FDA approved)
    cito:isDiscussedBy IRI* ;                    # Patent references
    rdfs:seeAlso IRI* ;                          # External database links
    vocab:is_active_ingredient_of IRI* ;
  }
  
  <DescriptorShape> {
    a IRI ;                                       # Descriptor type (molecular formula, weight, SMILES, etc.)
    sio:SIO_000300 . ;                           # Mixed types: xsd:string, xsd:double, xsd:integer
  }
  
  <SubstanceShape> {
    a [ vocab:Substance ] ;
    a IRI* ;                                      # CHEBI ontology mappings
    vocab:is_standardized_into @<CompoundShape>* ;
  }
  
  <BioAssayShape> {
    a [ vocab:BioAssay ] ;
    a [ bao:BAO_0000015 ]? ;
  }

sample_rdf_entries:
  - title: Compound with molecular descriptors (Aspirin)
    description: Compound entity with comprehensive molecular descriptors including SMILES, InChI, molecular formula, weight, and physicochemical properties.
    rdf: |
      @prefix compound: <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/> .
      @prefix descriptor: <http://rdf.ncbi.nlm.nih.gov/pubchem/descriptor/> .
      @prefix sio: <http://semanticscience.org/resource/> .
      @prefix vocab: <http://rdf.ncbi.nlm.nih.gov/pubchem/vocabulary#> .
      
      compound:CID2244 a vocab:Compound ;
        sio:SIO_000008 descriptor:CID2244_Molecular_Formula ,
                       descriptor:CID2244_Molecular_Weight ,
                       descriptor:CID2244_Canonical_SMILES ,
                       descriptor:CID2244_IUPAC_InChI ,
                       descriptor:CID2244_TPSA .
      
      descriptor:CID2244_Molecular_Formula 
        a sio:CHEMINF_000335 ;
        sio:SIO_000300 "C9H8O4" .
      
      descriptor:CID2244_Molecular_Weight
        a sio:CHEMINF_000334 ;
        sio:SIO_000300 180.16 .
      
      descriptor:CID2244_Canonical_SMILES
        a sio:CHEMINF_000376 ;
        sio:SIO_000300 "CC(=O)OC1=CC=CC=C1C(=O)O" .
      
      descriptor:CID2244_IUPAC_InChI
        a sio:CHEMINF_000396 ;
        sio:SIO_000300 "InChI=1S/C9H8O4/c1-6(10)13-8-5-3-2-4-7(8)9(11)12/h2-5H,1H3,(H,11,12)" .

  - title: Compound with ontology mappings and drug classification
    description: Compound entity showing ontology cross-references to ChEBI, SNOMED CT, NCI Thesaurus and FDA drug classification.
    rdf: |
      @prefix compound: <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/> .
      @prefix vocab: <http://rdf.ncbi.nlm.nih.gov/pubchem/vocabulary#> .
      @prefix chebi: <http://purl.obolibrary.org/obo/CHEBI_> .
      @prefix obo: <http://purl.obolibrary.org/obo/> .
      @prefix rdfs: <http://www.w3.org/2000/01/rdf-schema#> .
      
      compound:CID2244 a vocab:Compound ,
                         chebi:15365 ,
                         <http://purl.bioontology.org/ontology/SNOMEDCT/387458008> ,
                         <http://ncicb.nci.nih.gov/xml/owl/EVS/Thesaurus.owl#C287> ;
        obo:RO_0000087 vocab:FDAApprovedDrugs ;
        rdfs:seeAlso <http://www.wikidata.org/entity/Q18216> ,
                     <http://identifiers.org/ncit:C287> .

  - title: Stereoisomer relationships
    description: Compound entity demonstrating stereoisomer relationships linking related chemical structures.
    rdf: |
      @prefix compound: <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/> .
      @prefix cheminf: <http://semanticscience.org/resource/> .
      @prefix vocab: <http://rdf.ncbi.nlm.nih.gov/pubchem/vocabulary#> .
      
      compound:CID2244 a vocab:Compound ;
        cheminf:CHEMINF_000455 compound:CID450661 ,
                               compound:CID102100677 ,
                               compound:CID12280114 ,
                               compound:CID53699567 .

  - title: Substance entity with standardization relationship
    description: Substance entity showing ChEBI classification and its standardization into a compound.
    rdf: |
      @prefix substance: <http://rdf.ncbi.nlm.nih.gov/pubchem/substance/> .
      @prefix compound: <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/> .
      @prefix vocab: <http://rdf.ncbi.nlm.nih.gov/pubchem/vocabulary#> .
      @prefix chebi: <http://purl.obolibrary.org/obo/CHEBI_> .
      
      substance:SID17512640 a vocab:Substance ,
                              chebi:105061 ;
        vocab:is_standardized_into compound:CID5284378 .

  - title: Compound with patent references
    description: Compound entity showing patent discussion references from multiple jurisdictions.
    rdf: |
      @prefix compound: <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/> .
      @prefix patent: <http://rdf.ncbi.nlm.nih.gov/pubchem/patent/> .
      @prefix vocab: <http://rdf.ncbi.nlm.nih.gov/pubchem/vocabulary#> .
      @prefix cito: <http://purl.org/spar/cito/> .
      
      compound:CID2244 a vocab:Compound ;
        cito:isDiscussedBy patent:US-4960799-A ,
                           patent:EP-0002590-B1 ,
                           patent:CA-1301572-C ,
                           patent:CN-101495623-A .

sparql_query_examples:
  - title: Search compounds by label or name (keyword filtering)
    description: Find compound CIDs by searching for keywords in descriptors such as preferred IUPAC name or molecular formula.
    question: How can I find compound IDs containing the keyword "aspirin" or "acetyl"?
    complexity: basic
    sparql: |
      PREFIX compound: <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/>
      PREFIX sio: <http://semanticscience.org/resource/>
      PREFIX descriptor: <http://rdf.ncbi.nlm.nih.gov/pubchem/descriptor/>
      
      SELECT DISTINCT ?compound
      WHERE {
        ?compound a <http://rdf.ncbi.nlm.nih.gov/pubchem/vocabulary#Compound> ;
                  sio:SIO_000008 ?desc .
        ?desc a sio:CHEMINF_000382 ;
              sio:SIO_000300 ?name .
        FILTER(REGEX(?name, "aspirin|acetyl", "i"))
      }
      LIMIT 20

  - title: Get biological/functional annotations for compounds
    description: Retrieve drug roles, ontology classifications, and functional annotations for specified compound CIDs.
    question: What are the biological roles and classifications of compound CID2244?
    complexity: basic
    sparql: |
      PREFIX compound: <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      
      SELECT ?role ?ontologyType
      WHERE {
        compound:CID2244 obo:RO_0000087 ?role .
        OPTIONAL { compound:CID2244 a ?ontologyType .
          FILTER(?ontologyType != <http://rdf.ncbi.nlm.nih.gov/pubchem/vocabulary#Compound>)
        }
      }

  - title: Retrieve molecular descriptors for a compound
    description: Get comprehensive molecular descriptors including formula, weight, SMILES, InChI, and physicochemical properties for a specific compound.
    question: What are the molecular properties of aspirin (CID2244)?
    complexity: intermediate
    sparql: |
      PREFIX compound: <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/>
      PREFIX sio: <http://semanticscience.org/resource/>
      
      SELECT ?descriptorType ?value
      WHERE {
        compound:CID2244 sio:SIO_000008 ?descriptor .
        ?descriptor a ?descriptorType ;
                    sio:SIO_000300 ?value .
        FILTER(?descriptorType IN (
          sio:CHEMINF_000335,  # Molecular formula
          sio:CHEMINF_000334,  # Molecular weight
          sio:CHEMINF_000376,  # Canonical SMILES
          sio:CHEMINF_000396,  # InChI
          sio:CHEMINF_000392   # TPSA
        ))
      }

  - title: Find FDA-approved drugs by molecular weight range
    description: Identify FDA-approved drug compounds within a specified molecular weight range.
    question: Which FDA-approved drugs have molecular weights between 150 and 200?
    complexity: intermediate
    sparql: |
      PREFIX compound: <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/>
      PREFIX vocab: <http://rdf.ncbi.nlm.nih.gov/pubchem/vocabulary#>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX sio: <http://semanticscience.org/resource/>
      
      SELECT ?compound ?weight
      WHERE {
        ?compound a vocab:Compound ;
                  obo:RO_0000087 vocab:FDAApprovedDrugs ;
                  sio:SIO_000008 ?weightDesc .
        ?weightDesc a sio:CHEMINF_000334 ;
                    sio:SIO_000300 ?weight .
        FILTER(?weight >= 150 && ?weight <= 200)
      }
      LIMIT 100

  - title: Count compounds by ChEBI classification
    description: Aggregate compounds grouped by their ChEBI ontology classifications to understand chemical diversity.
    question: How many compounds are there for each ChEBI class?
    complexity: intermediate
    sparql: |
      PREFIX vocab: <http://rdf.ncbi.nlm.nih.gov/pubchem/vocabulary#>
      PREFIX chebi: <http://purl.obolibrary.org/obo/CHEBI_>
      
      SELECT ?chebiClass (COUNT(DISTINCT ?compound) as ?count)
      WHERE {
        ?compound a vocab:Compound ;
                  a ?chebiClass .
        FILTER(STRSTARTS(STR(?chebiClass), STR(chebi:)))
      }
      GROUP BY ?chebiClass
      ORDER BY DESC(?count)
      LIMIT 50

  - title: Find stereoisomers and their descriptors
    description: Retrieve all stereoisomers of a compound along with their canonical SMILES to compare structural variations.
    question: What are the stereoisomers of CID2244 and their SMILES structures?
    complexity: advanced
    sparql: |
      PREFIX compound: <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/>
      PREFIX cheminf: <http://semanticscience.org/resource/>
      PREFIX sio: <http://semanticscience.org/resource/>
      
      SELECT ?stereoisomer ?smiles
      WHERE {
        compound:CID2244 cheminf:CHEMINF_000455 ?stereoisomer .
        ?stereoisomer sio:SIO_000008 ?smilesDesc .
        ?smilesDesc a sio:CHEMINF_000376 ;
                    sio:SIO_000300 ?smiles .
      }
      LIMIT 50

  - title: Complex compound-patent-ontology integration
    description: Integrate compounds with their patent references, drug classifications, and ontology mappings for comprehensive pharmaceutical analysis.
    question: Which FDA-approved compounds have patent coverage and ChEBI classifications?
    complexity: advanced
    sparql: |
      PREFIX compound: <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/>
      PREFIX vocab: <http://rdf.ncbi.nlm.nih.gov/pubchem/vocabulary#>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX cito: <http://purl.org/spar/cito/>
      PREFIX chebi: <http://purl.obolibrary.org/obo/CHEBI_>
      
      SELECT ?compound (COUNT(DISTINCT ?patent) as ?patentCount) (GROUP_CONCAT(DISTINCT ?chebiClass; separator=", ") as ?chebiClasses)
      WHERE {
        ?compound a vocab:Compound ;
                  obo:RO_0000087 vocab:FDAApprovedDrugs ;
                  cito:isDiscussedBy ?patent ;
                  a ?chebiClass .
        FILTER(STRSTARTS(STR(?chebiClass), STR(chebi:)))
      }
      GROUP BY ?compound
      HAVING (COUNT(DISTINCT ?patent) > 5)
      ORDER BY DESC(?patentCount)
      LIMIT 20

cross_references:
  - pattern: rdfs:seeAlso
    description: |
      External database links use rdfs:seeAlso property.
      Databases distinguished by URL patterns in the IRI.
    databases:
      knowledge_bases:
        - Wikidata (wikidata.org/entity/): ~2-5% coverage
        - identifiers.org: Various namespaces
      chemical_ontologies:
        - NCI Thesaurus (ncit:): Integrated via identifiers.org
    complexity: basic
    sparql: |
      PREFIX compound: <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/>
      PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
      
      SELECT ?compound ?externalDB
      WHERE {
        ?compound a <http://rdf.ncbi.nlm.nih.gov/pubchem/vocabulary#Compound> ;
                  rdfs:seeAlso ?externalDB .
      }
      LIMIT 100
  
  - pattern: rdf:type (Ontology Mappings)
    description: |
      Compounds and substances are typed with ontology classes to indicate chemical classifications.
      Multiple ontologies used including ChEBI, SNOMED CT, NCI Thesaurus.
    databases:
      chemical_ontologies:
        - ChEBI (purl.obolibrary.org/obo/CHEBI_): ~5-10% coverage
        - SNOMED CT (purl.bioontology.org/ontology/SNOMEDCT/): Significant coverage for drugs
        - NCI Thesaurus (ncicb.nci.nih.gov/xml/owl/EVS/Thesaurus.owl): Drug compounds
    complexity: basic
    sparql: |
      PREFIX vocab: <http://rdf.ncbi.nlm.nih.gov/pubchem/vocabulary#>
      
      SELECT ?compound ?ontologyClass
      WHERE {
        ?compound a vocab:Compound ;
                  a ?ontologyClass .
        FILTER(?ontologyClass != vocab:Compound)
      }
      LIMIT 100
  
  - pattern: cito:isDiscussedBy
    description: |
      Patent references use the Citation Typing Ontology (CiTO) property isDiscussedBy.
      Links to patent documents from multiple jurisdictions (US, EP, CN, CA, etc.).
    databases:
      patents:
        - US Patents: Extensive coverage
        - European Patents (EP): Extensive coverage
        - Chinese Patents (CN): Extensive coverage
        - Canadian Patents (CA): Extensive coverage
        - Other jurisdictions: AU, BR, EA, etc.
    complexity: basic
    sparql: |
      PREFIX compound: <http://rdf.ncbi.nlm.nih.gov/pubchem/compound/>
      PREFIX cito: <http://purl.org/spar/cito/>
      
      SELECT ?compound (COUNT(?patent) as ?patentCount)
      WHERE {
        ?compound a <http://rdf.ncbi.nlm.nih.gov/pubchem/vocabulary#Compound> ;
                  cito:isDiscussedBy ?patent .
        FILTER(STRSTARTS(STR(?patent), "http://rdf.ncbi.nlm.nih.gov/pubchem/patent/"))
      }
      GROUP BY ?compound
      ORDER BY DESC(?patentCount)
      LIMIT 100

architectural_notes:
  schema_design:
    - Compounds are central hub entities linked to descriptors, substances, patents, and bioassays
    - Descriptor pattern uses SIO ontology (SIO_000008 to link, SIO_000300 for values)
    - Multi-layer architecture with separate graphs for compounds, descriptors, substances, bioassays
    - Ontology integration through rdf:type for chemical classifications (ChEBI, SNOMED CT, NCI)
    - Stereoisomer network through CHEMINF_000455 relationships
  
  performance:
    - CID-specific queries are efficient
    - Label/name REGEX searches timeout without CID filtering
    - Molecular weight range filtering works well up to 10K results
    - Descriptor queries optimized when compound IDs are specified
    - Aggregation queries with GROUP BY work well for <50K compounds
    - Patent count queries can be slow without LIMIT
  
  data_integration:
    - External databases via rdfs:seeAlso (Wikidata, identifiers.org)
    - Chemical ontologies via rdf:type (ChEBI, SNOMED CT, NCI Thesaurus)
    - Patent linkage via cito:isDiscussedBy
    - Substance-to-compound standardization via vocab:is_standardized_into
    - Drug classification via obo:RO_0000087 (role relationships)
    - Bioassay Ontology (BAO) integration for assays
  
  data_quality:
    - Descriptor values have mixed types (string/double/integer) depending on property
    - Not all compounds have complete descriptor sets
    - External links vary significantly in completeness (2-95% coverage)
    - Ontology mappings primarily for drugs and biologically relevant compounds
    - Patent coverage varies by compound (drugs have more patents)
    - Some descriptor values may be missing for newly added compounds

data_statistics:
  total_compounds: 119093251
  total_substances: 339000000
  total_bioassays: 1300000
  fda_approved_drugs: 17367
  
  coverage:
    compounds_with_molecular_formula: ">99%"
    compounds_with_molecular_weight: ">99%"
    compounds_with_smiles: ">99%"
    compounds_with_inchi: ">95%"
    compounds_with_tpsa: ">95%"
    compounds_with_wikidata_links: "~2%"
    compounds_with_chebi_classification: "~5%"
    compounds_with_snomedct_classification: "~3%"
    compounds_with_patent_refs: "~10%"
    compounds_with_drug_roles: "~1-2%"
  
  cardinality:
    avg_descriptors_per_compound: 25
    max_descriptors_per_compound: 50
    avg_stereoisomers_per_compound: 2.3
    max_stereoisomers_per_compound: 740
    avg_patents_per_compound: 8.5
    max_patents_per_compound: 500
    avg_ontology_types_per_compound: 3.2
    max_ontology_types_per_compound: 15
  
  performance_characteristics:
    - "CID-based queries are fast and efficient"
    - "Label/name REGEX searches timeout without specific CID filtering"
    - "Molecular weight range queries efficient up to 10K results"
    - "Descriptor retrieval optimized when compound ID is specified"
    - "Cross-graph compound+descriptor joins are optimized"
    - "Recommend LIMIT 100 for exploratory queries without CID filter"
    - "Stereoisomer queries can return many rows per compound (use LIMIT)"
    - "Patent count aggregations work well with GROUP BY and LIMIT"
  
  data_quality_notes:
    - "Descriptor values use mixed types (string/decimal/integer) based on property"
    - "External links vary in completeness (Wikidata ~2%, patents ~10%)"
    - "Ontology mappings primarily for drugs and biologically relevant molecules"
    - "Not all compounds have complete stereoisomer networks"
    - "Some newly added compounds may have incomplete descriptor sets"
schema_info:
  title: "ChEBI (Chemical Entities of Biological Interest)"
  description: "A comprehensive database and ontology of molecular entities of biological interest, including small molecular entities, proteins, nucleic acids, complex carbohydrates, and other biological macromolecules. ChEBI provides a structured vocabulary for chemical entities involved in biochemical processes."
  endpoint: "https://rdfportal.org/backend/ebi/sparql"
  base_uri: "http://purl.obolibrary.org/obo/"
  graphs:
    - "http://rdf.ebi.ac.uk/dataset/chebi"
  version: "2024"
  license: "CC BY 4.0"
  homepage: "https://www.ebi.ac.uk/chebi/"

shape_expressions: |
  # ChEBI Chemical Entity ShEx Schema
  # All prefixes are defined here as part of the ShEx schema
  
  PREFIX rdf: <http://www.w3.org/1999/02/22-rdf-syntax-ns#>
  PREFIX rdfs: <http://www.w3.org/2000/01/rdf-schema#>
  PREFIX owl: <http://www.w3.org/2002/07/owl#>
  PREFIX obo: <http://purl.obolibrary.org/obo/>
  PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
  PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
  PREFIX IAO: <http://purl.obolibrary.org/obo/IAO_>
  PREFIX ro: <http://purl.obolibrary.org/obo/RO_>
  
  # ChEBI Chemical Entity Shape
  :ChEBIEntity {
    # Core OWL typing
    rdf:type [ owl:Class ] ;
    
    # Required properties
    rdfs:label xsd:string ;  # Primary name of the chemical entity
    
    # Hierarchical classification
    rdfs:subClassOf @:ChEBIEntity * ;  # Parent chemical classes
    rdfs:subClassOf @:Restriction * ;  # Role-based restrictions
    
    # Chemical structural properties
    chebi:formula xsd:string ? ;  # Molecular formula
    chebi:mass xsd:decimal ? ;  # Molecular mass in daltons
    chebi:monoisotopicmass xsd:decimal ? ;  # Monoisotopic mass
    chebi:charge xsd:integer ? ;  # Net charge of the molecule
    chebi:inchi xsd:string ? ;  # IUPAC International Chemical Identifier
    chebi:inchikey xsd:string ? ;  # Hashed version of InChI
    chebi:smiles xsd:string ? ;  # SMILES chemical structure notation
    
    # Annotations
    IAO:0000115 xsd:string ? ;  # Textual definition
    oboInOwl:hasExactSynonym xsd:string * ;  # Exact synonyms
    oboInOwl:hasRelatedSynonym xsd:string * ;  # Related synonyms
    oboInOwl:hasDbXref xsd:string * ;  # External database cross-references
    oboInOwl:hasAlternativeId xsd:string * ;  # Alternative ChEBI IDs
    oboInOwl:id xsd:string ? ;  # ChEBI identifier
    oboInOwl:hasOBONamespace xsd:string ? ;  # OBO namespace
    oboInOwl:inSubset IRI * ;  # Subset membership (e.g., 3_STAR)
  }
  
  # Restriction Shape for Role Relationships
  :Restriction {
    rdf:type [ owl:Restriction ] ;
    owl:onProperty IRI ;  # The role property (e.g., RO:0000087)
    owl:someValuesFrom @:ChEBIEntity ;  # The role or function
  }

sample_rdf_entries:
  - title: "Biotin - B-Vitamin and Cofactor"
    description: "Complex organic molecule with detailed chemical properties and extensive cross-references"
    rdf: |
      obo:CHEBI_15956 a owl:Class ;
          rdfs:label "biotin" ;
          rdfs:subClassOf obo:CHEBI_51570, obo:CHEBI_176841 ;
          chebi:formula "C10H16N2O3S" ;
          chebi:mass "244.31172" ;
          chebi:monoisotopicmass "244.08816" ;
          chebi:charge "0" ;
          chebi:inchi "InChI=1S/C10H16N2O3S/c13-8(14)4-2-1-3-7-9-6(5-16-7)11-10(15)12-9/h6-7,9H,1-5H2,(H,13,14)(H2,11,12,15)/t6-,7-,9-/m0/s1" ;
          chebi:inchikey "YBJHBAHKTGYVGT-ZKWXMUAHSA-N" ;
          chebi:smiles "[H][C@]12CS[C@@H](CCCCC(O)=O)[C@@]1([H])NC(=O)N2" ;
          IAO:0000115 "An organic heterobicyclic compound that consists of 2-oxohexahydro-1H-thieno[3,4-d]imidazole having a valeric acid substituent attached to the tetrahydrothiophene ring." ;
          oboInOwl:hasExactSynonym "BIOTIN", "5-[(3aS,4S,6aR)-2-oxohexahydro-1H-thieno[3,4-d]imidazol-4-yl]pentanoic acid" ;
          oboInOwl:hasRelatedSynonym "Vitamin H", "Coenzyme R", "vitamin B7" ;
          oboInOwl:hasDbXref "CAS:58-85-5", "KEGG:C00120", "DrugBank:DB00121", "HMDB:HMDB0000030" ;
          oboInOwl:id "CHEBI:15956" .

  - title: "Phosphorus Atom - Basic Element"
    description: "Simple atomic entity with minimal but essential chemical properties"
    rdf: |
      obo:CHEBI_28659 a owl:Class ;
          rdfs:label "phosphorus atom" ;
          rdfs:subClassOf obo:CHEBI_25585, obo:CHEBI_33300 ;
          chebi:formula "P" ;
          chebi:mass "30.97376" ;
          chebi:monoisotopicmass "30.97376" ;
          chebi:charge "0" ;
          chebi:inchi "InChI=1S/P" ;
          chebi:inchikey "OAICVXFJPJFONN-UHFFFAOYSA-N" ;
          chebi:smiles "[P]" ;
          oboInOwl:hasRelatedSynonym "P", "15P", "Phosphor", "phosphorus" ;
          oboInOwl:hasDbXref "CAS:7723-14-0", "KEGG:C06262", "WebElements:P" ;
          oboInOwl:hasAlternativeId "CHEBI:26080" .

  - title: "Malathion - Pesticide with Drug Properties"
    description: "Complex organophosphorus compound with therapeutic and toxicological significance"
    rdf: |
      obo:CHEBI_6651 a owl:Class ;
          rdfs:label "malathion" ;
          oboInOwl:hasDbXref "CAS:121-75-5", "DrugBank:DB00772", "KEGG:C07497", "KEGG:D00534" ;
          oboInOwl:hasDbXref "PMID:16083681", "PMID:19399610", "PMID:28950791" .

  - title: "Ciprofloxacin - Antibiotic with Multiple Roles"
    description: "Fluoroquinolone antibiotic demonstrating role-based classification in ChEBI"
    rdf: |
      obo:CHEBI_100241 a owl:Class ;
          rdfs:label "ciprofloxacin" ;
          rdfs:subClassOf [
              a owl:Restriction ;
              owl:onProperty ro:0000087 ;
              owl:someValuesFrom obo:CHEBI_33281  # antimicrobial agent
          ], [
              a owl:Restriction ;
              owl:onProperty ro:0000087 ;
              owl:someValuesFrom obo:CHEBI_36047  # antibacterial drug
          ], [
              a owl:Restriction ;
              owl:onProperty ro:0000087 ;
              owl:someValuesFrom obo:CHEBI_50750  # DNA topoisomerase inhibitor
          ] .

  - title: "Xylose - Simple Sugar"
    description: "Pentose sugar with basic chemical properties typical of carbohydrates"
    rdf: |
      obo:CHEBI_18222 a owl:Class ;
          rdfs:label "xylose" ;
          chebi:formula "C5H10O5" ;
          chebi:mass "150.130" .

  - title: "Triolein - Complex Lipid"
    description: "Triglyceride lipid with high molecular mass demonstrating lipid classification"
    rdf: |
      obo:CHEBI_53753 a owl:Class ;
          rdfs:label "triolein" ;
          chebi:formula "C57H104O6" ;
          chebi:mass "885.43210" .

sparql_query_examples:
  - title: "Find Chemical Entities by Molecular Formula"
    description: "Search for compounds with a specific molecular formula, useful for identifying isomers and chemical variants"
    question: "What chemical entities have the molecular formula C10H16N2O3S?"
    complexity: "basic"
    sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      SELECT ?entity ?label ?mass
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity rdfs:label ?label ;
                chebi:formula "C10H16N2O3S" ;
                chebi:mass ?mass .
        FILTER(STRSTARTS(STR(?entity), "http://purl.obolibrary.org/obo/CHEBI_"))
      }
      ORDER BY ?mass

  - title: "Explore Chemical Hierarchy"
    description: "Retrieve the most populous chemical classes to understand ChEBI's taxonomic organization"
    question: "What are the most common chemical classes in ChEBI and how many subclasses do they have?"
    complexity: "intermediate"
    sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      SELECT ?superclass ?superclass_label (COUNT(?subclass) as ?subclass_count)
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?subclass rdfs:subClassOf ?superclass .
        ?superclass rdfs:label ?superclass_label .
        FILTER(STRSTARTS(STR(?superclass), "http://purl.obolibrary.org/obo/CHEBI_"))
        FILTER(STRSTARTS(STR(?subclass), "http://purl.obolibrary.org/obo/CHEBI_"))
      }
      GROUP BY ?superclass ?superclass_label
      ORDER BY DESC(?subclass_count)
      LIMIT 15

  - title: "Search Compounds by Mass Range"
    description: "Find compounds within a specific molecular mass range, useful for mass spectrometry applications"
    question: "Which compounds have molecular masses between 100 and 200 daltons?"
    complexity: "basic"
    sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      SELECT ?entity ?label ?formula ?mass
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity rdfs:label ?label ;
                chebi:formula ?formula ;
                chebi:mass ?mass .
        FILTER(?mass >= 100 && ?mass <= 200)
        FILTER(STRSTARTS(STR(?entity), "http://purl.obolibrary.org/obo/CHEBI_"))
      }
      ORDER BY ?mass
      LIMIT 20

  - title: "Find Compounds with Specific Chemical Properties"
    description: "Locate entities with both InChI and SMILES representations for cheminformatics applications"
    question: "Which compounds have both InChI and SMILES notations available?"
    complexity: "intermediate"
    sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      SELECT ?entity ?label ?inchi ?smiles
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity rdfs:label ?label ;
                chebi:inchi ?inchi ;
                chebi:smiles ?smiles .
        FILTER(STRSTARTS(STR(?entity), "http://purl.obolibrary.org/obo/CHEBI_"))
      }
      LIMIT 15

  - title: "Discover Drug-Related Entities"
    description: "Find compounds that have drug-related roles, demonstrating ChEBI's functional classification"
    question: "What compounds have antimicrobial or antibacterial properties?"
    complexity: "advanced"
    sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX ro: <http://purl.obolibrary.org/obo/RO_>
      SELECT DISTINCT ?entity ?label ?role ?role_label
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity rdfs:label ?label .
        ?entity rdfs:subClassOf ?restriction .
        ?restriction a owl:Restriction .
        ?restriction owl:onProperty ro:0000087 .
        ?restriction owl:someValuesFrom ?role .
        ?role rdfs:label ?role_label .
        FILTER(STRSTARTS(STR(?entity), "http://purl.obolibrary.org/obo/CHEBI_"))
        FILTER(REGEX(?role_label, "antimicrobial|antibacterial", "i"))
      }
      ORDER BY ?label

  - title: "Find Synonyms and Alternative Names"
    description: "Retrieve comprehensive naming information for chemical entities, including exact and related synonyms"
    question: "What are all the known names and synonyms for biotin?"
    complexity: "basic"
    sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      SELECT ?label ?synonym_type ?synonym
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        obo:CHEBI_15956 rdfs:label ?label .
        {
          obo:CHEBI_15956 oboInOwl:hasExactSynonym ?synonym .
          BIND("exact" AS ?synonym_type)
        } UNION {
          obo:CHEBI_15956 oboInOwl:hasRelatedSynonym ?synonym .
          BIND("related" AS ?synonym_type)
        }
      }
      ORDER BY ?synonym_type ?synonym

  - title: "Analyze Entity Definitions"
    description: "Retrieve textual definitions for chemical entities to understand their biological significance"
    question: "What are the formal definitions of vitamin-related compounds?"
    complexity: "intermediate"
    sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX IAO: <http://purl.obolibrary.org/obo/IAO_>
      SELECT ?entity ?label ?definition
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity rdfs:label ?label ;
                IAO:0000115 ?definition .
        FILTER(STRSTARTS(STR(?entity), "http://purl.obolibrary.org/obo/CHEBI_"))
        FILTER(REGEX(?label, "vitamin", "i"))
      }
      ORDER BY ?label

  - title: "Count Database Cross-References"
    description: "Analyze the connectivity of ChEBI entities to external databases for data integration purposes"
    question: "How many external database references does each compound type have?"
    complexity: "advanced"
    sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      SELECT ?entity ?label (COUNT(?xref) as ?xref_count)
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity rdfs:label ?label ;
                oboInOwl:hasDbXref ?xref .
        FILTER(STRSTARTS(STR(?entity), "http://purl.obolibrary.org/obo/CHEBI_"))
      }
      GROUP BY ?entity ?label
      ORDER BY DESC(?xref_count)
      LIMIT 20

  - title: "Find Charged Molecular Entities"
    description: "Identify ionic species and their charges, important for understanding chemical reactivity"
    question: "What are examples of positively and negatively charged molecular entities?"
    complexity: "basic"
    sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      SELECT ?entity ?label ?charge ?formula
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity rdfs:label ?label ;
                chebi:charge ?charge ;
                chebi:formula ?formula .
        FILTER(?charge != 0)
        FILTER(STRSTARTS(STR(?entity), "http://purl.obolibrary.org/obo/CHEBI_"))
      }
      ORDER BY ?charge ?label
      LIMIT 20

cross_references:
  - title: "CAS Registry Number Cross-References"
    description: "Map ChEBI entities to Chemical Abstracts Service registry numbers for chemical identification"
    complexity: "basic"
    sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      SELECT ?entity ?label ?cas_number
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity rdfs:label ?label ;
                oboInOwl:hasDbXref ?xref .
        FILTER(STRSTARTS(STR(?entity), "http://purl.obolibrary.org/obo/CHEBI_"))
        FILTER(STRSTARTS(?xref, "CAS:"))
        BIND(STRAFTER(?xref, "CAS:") AS ?cas_number)
      }
      ORDER BY ?label
      LIMIT 20

  - title: "KEGG Database Links"
    description: "Connect ChEBI entities to KEGG pathways and compounds for metabolic analysis"
    complexity: "intermediate"
    sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      SELECT ?entity ?label ?kegg_id ?kegg_type
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity rdfs:label ?label ;
                oboInOwl:hasDbXref ?xref .
        FILTER(STRSTARTS(STR(?entity), "http://purl.obolibrary.org/obo/CHEBI_"))
        FILTER(STRSTARTS(?xref, "KEGG:"))
        BIND(STRAFTER(?xref, "KEGG:") AS ?kegg_id)
        BIND(IF(STRSTARTS(?kegg_id, "C"), "compound", 
             IF(STRSTARTS(?kegg_id, "D"), "drug", "other")) AS ?kegg_type)
      }
      ORDER BY ?kegg_type ?label

  - title: "DrugBank Cross-References"
    description: "Link ChEBI chemical entities to DrugBank for pharmaceutical information"
    complexity: "basic"
    sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      SELECT ?entity ?label ?drugbank_id
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity rdfs:label ?label ;
                oboInOwl:hasDbXref ?xref .
        FILTER(STRSTARTS(STR(?entity), "http://purl.obolibrary.org/obo/CHEBI_"))
        FILTER(STRSTARTS(?xref, "DrugBank:"))
        BIND(STRAFTER(?xref, "DrugBank:") AS ?drugbank_id)
      }
      ORDER BY ?label

  - title: "PubMed Literature References"
    description: "Access scientific literature associated with chemical entities through PubMed IDs"
    complexity: "intermediate"
    sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      SELECT ?entity ?label (COUNT(?pmid) as ?publication_count)
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity rdfs:label ?label ;
                oboInOwl:hasDbXref ?xref .
        FILTER(STRSTARTS(STR(?entity), "http://purl.obolibrary.org/obo/CHEBI_"))
        FILTER(STRSTARTS(?xref, "PMID:"))
        BIND(STRAFTER(?xref, "PMID:") AS ?pmid)
      }
      GROUP BY ?entity ?label
      ORDER BY DESC(?publication_count)
      LIMIT 15

  - title: "Multiple Database Cross-References"
    description: "Comprehensive cross-reference analysis showing database coverage for each entity"
    complexity: "advanced"
    sparql: |
      PREFIX chebi: <http://purl.obolibrary.org/obo/chebi/>
      PREFIX obo: <http://purl.obolibrary.org/obo/>
      PREFIX oboInOwl: <http://www.geneontology.org/formats/oboInOwl#>
      SELECT ?entity ?label ?database ?identifier
      FROM <http://rdf.ebi.ac.uk/dataset/chebi>
      WHERE {
        ?entity rdfs:label ?label ;
                oboInOwl:hasDbXref ?xref .
        FILTER(STRSTARTS(STR(?entity), "http://purl.obolibrary.org/obo/CHEBI_"))
        BIND(IF(CONTAINS(?xref, ":"), STRBEFORE(?xref, ":"), ?xref) AS ?database)
        BIND(IF(CONTAINS(?xref, ":"), STRAFTER(?xref, ":"), "") AS ?identifier)
        FILTER(?database IN ("CAS", "KEGG", "DrugBank", "HMDB", "PDBeChem", "Wikipedia"))
      }
      ORDER BY ?label ?database

architectural_notes:
  design_patterns:
    - "ChEBI follows OBO Foundry principles with standardized URI patterns using http://purl.obolibrary.org/obo/CHEBI_"
    - "Hierarchical classification through rdfs:subClassOf enables taxonomic browsing and inheritance reasoning"
    - "Role-based functional classification uses OWL restrictions with the 'has role' (RO:0000087) property"
    - "Chemical structure representations include multiple formats: InChI, InChIKey, SMILES for interoperability"
    - "Extensive cross-referencing to external databases supports data integration across chemical resources"
    
  performance_considerations:
    - "Mass range queries benefit from numeric filtering and indexing on chebi:mass property"
    - "Formula-based searches should use exact string matching on chebi:formula"
    - "Hierarchy traversal queries may require SPARQL path expressions for deep relationships"
    - "Cross-reference queries can be expensive; consider limiting results or filtering by specific databases"
    - "Text searches on labels and synonyms should use FILTER with REGEX for flexibility"
    
  data_quality_notes:
    - "Not all entities have complete chemical property data (InChI, SMILES, mass)"
    - "Alternative IDs (hasAlternativeId) represent deprecated or merged entity identifiers"
    - "3_STAR subset contains manually curated, high-quality entities"
    - "Some entities may have multiple exact synonyms reflecting chemical naming conventions"
    - "Cross-references vary in completeness depending on the external database and entity type"

data_statistics:
  total_classes: 217368
  total_axioms: 580521
  total_restrictions: 91781
  annotation_properties: 37
  object_properties: 10
  key_metrics:
    entities_with_formula: "~50000"
    entities_with_mass: "~45000"
    entities_with_inchi: "~30000"
    entities_with_smiles: "~25000"
    entities_with_roles: "~15000"
    cross_reference_count: "~500000"
  top_chemical_classes:
    - class: "azamacrocycle"
      count: 7532
    - class: "peptide" 
      count: 7415
    - class: "lactam"
      count: 7409
    - class: "aromatic ether"
      count: 3217
    - class: "organic molecular entity"
      count: 3010
